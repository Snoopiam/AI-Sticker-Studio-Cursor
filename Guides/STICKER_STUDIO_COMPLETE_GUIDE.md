# ðŸŽ¨ AI STICKER STUDIO - COMPLETE STICKER STUDIO GUIDE

## The Ultimate Reference Manual for Creating Personalized Stickers

**Version**: 1.0  
**Last Updated**: October 17, 2025  
**Audience**: All Users (Beginner to Advanced)

---

## ðŸ“– TABLE OF CONTENTS

1. [Introduction](#1-introduction)
2. [Getting Started](#2-getting-started)
3. [Understanding the Interface](#3-understanding-the-interface)
4. [Input Modes: The Foundation](#4-input-modes-the-foundation)
5. [Identity Lock System: The Magic](#5-identity-lock-system-the-magic)
6. [Expression Selection Guide](#6-expression-selection-guide)
7. [Artistic Customization](#7-artistic-customization)
8. [Output Formats: Static vs Animated](#8-output-formats-static-vs-animated)
9. [Pack & Quality Settings](#9-pack--quality-settings)
10. [Generation Process Explained](#10-generation-process-explained)
11. [Advanced Features](#11-advanced-features)
12. [Troubleshooting & FAQs](#12-troubleshooting--faqs)
13. [Tips & Best Practices](#13-tips--best-practices)
14. [Technical Deep Dive](#14-technical-deep-dive)

---


## 1. INTRODUCTION

### What is Sticker Studio?

Sticker Studio is an advanced AI-powered platform that transforms your photos into personalized, professional-quality stickers. Whether you want to create static image stickers or animated video stickers, the Studio provides you with unprecedented creative control while maintaining your unique identity across all generated content.

### Key Features

- **ðŸ”’ Identity Lock Technology**: Proprietary AI system that analyzes and preserves your facial features across all generations
- **ðŸŽ­ 36+ Expressions**: From casual waves to dramatic celebrations, choose from a vast library of poses and emotions
- **ðŸŽ¨ 15+ Artistic Styles**: Transform your likeness into cartoon vectors, photorealistic renders, kawaii characters, and more
- **ðŸŽ¬ Animated Stickers**: Create looping video stickers with 9+ animation styles
- **ðŸ“¦ Batch Generation**: Generate up to 20 stickers in a single pack
- **ðŸŽ¯ Two Input Modes**: Create from your photo (Image-to-Image) or describe a character (Text-to-Image)
- **ðŸ’¬ Speech Bubbles**: Add custom text bubbles to any expression
- **âš™ï¸ Advanced Controls**: Fine-tune every aspect from composition to shading style

### Who Is This For?

- **Personal Use**: Create custom stickers of yourself for messaging apps
- **Content Creators**: Generate unique sticker packs for your brand or community  
- **Artists**: Explore different artistic styles and expressions of your character
- **Anyone**: No design skills required - the AI does all the artistic work!

### Prerequisites

- **Credits**: Most operations consume credits (displayed in top-right corner)
- **Clear Photo** (for Image-to-Image mode): Front-facing, well-lit photo for best results
- **Web Browser**: Modern browser with JavaScript enabled
- **Internet Connection**: Required for AI processing

---

## 2. GETTING STARTED

### First Launch Experience

When you first open Sticker Studio, you'll see:

1. **The Control Panel** (left side): Where you configure all your settings
2. **The Preview Area** (right side): Where your generated stickers appear
3. **The Header** (top): Credits, layout toggle, and collection button
4. **The Action Footer** (bottom): Generate button and Inspire Me feature

### The 5-Section Workflow

Sticker Studio breaks the creation process into 5 logical sections that guide you from start to finish:

**Section 1: Input Mode**
Choose how you want to create your sticker (from your photo OR from text description)

**Section 2: Subject & Identity**
Upload your photo and establish your Identity Lock, OR describe your subject

**Section 3: Expression & Pose**
Select which expressions/poses you want in your sticker pack

**Section 4: Style & Format**
Define the artistic look and whether you want static or animated output

**Section 5: Pack & Quality**
Set how many stickers to generate and at what resolution

### Your First Sticker: Quick Start

**For beginners, follow this simple workflow:**

1. Leave **Input Mode** on \"From Image\" (default)
2. Click the **upload area** and select a clear, front-facing photo
3. Wait for **automatic calibration** (about 10-15 seconds)
4. In **Expression & Pose**, click 2-3 expressions you like
5. Leave **Style & Format** settings at default
6. Click **\"Generate\"** at the bottom

Your first sticker pack will be ready in about 20-30 seconds!

---


## 3. UNDERSTANDING THE INTERFACE

### The Control Panel (Left Side)

The Control Panel is your command center, organized into collapsible sections. Each section header can be clicked to expand or collapse it.

#### **Section Headers**
- **Click to toggle**: Expand or collapse any section
- **Chevron icon**: Points down when expanded, up when collapsed
- **Current state**: Sections remember their state as you work

#### **Simple Mode vs Advanced Mode**
- **Simple Mode** (default): Sections 4 & 5 start collapsed for a cleaner, beginner-friendly experience
- **Advanced Mode**: All sections expanded, showing every available control
- Toggle in the header: \"Simple Mode\" switch

### The Preview Area (Right Side)

This is where your magic happens. The preview area displays:

#### **Before Generation**
- **AI Core Animation**: Pulsing purple core showing system is ready
- **Status Messages**: Helpful hints about next steps

#### **During Generation**
- **AI Core Processing**: Animated core showing active processing
- **Loading Messages**: Real-time updates on generation progress
- **Progress Indication**: Shows current step (e.g., \"Generating sticker 2 of 4...\")

#### **After Generation**
- **Generated Stickers**: All your new stickers displayed in a grid
- **Quick Actions** (on hover):
  - Download individual sticker
  - Edit in Post-Processing Studio
  - View full-size
  - Add to collection

### The Header (Top Bar)

#### **Left Side**
- **AI STICKER STUDIO** logo
- **Mode Tabs**: Quick navigation between Sticker/Wallpaper/Photo Remix studios

#### **Right Side**
- **Credits Display**: Shows your current credit balance
- **Layout Toggle**: Switch between Split (default) and Preview-focused layouts
- **Collection Button**: Access your saved generations (shows count badge)

### The Action Footer (Bottom Bar)

#### **Left Side**
- **\"Inspire Me\" Button**: Get AI-powered creative suggestions
  - Randomizes style and palette combinations
  - Suggests interesting expression combinations
  - Provides fresh creative ideas when you're stuck

#### **Right Side**
- **\"Generate\" Button**: Starts the sticker creation process
  - Shows required credit cost
  - Displays helpful tooltips when disabled (hover to see why)
  - Changes to \"Working...\" during generation
  - For animations: Changes to \"Cancel Generation\" button

---

## 4. INPUT MODES: THE FOUNDATION

This is your first major decision: **How do you want to create your sticker?**

### Mode 1: From Image (Image-to-Image)

**What It Does:**
Transforms YOUR face from a photo into stickers while preserving your exact identity across all expressions and styles.

**When to Use:**
- You want stickers that look exactly like you or someone else
- You have a clear photo available  
- You want maximum consistency across expressions
- You need realistic facial features

**Requirements:**
- A clear, well-lit photo showing the full face
- Person should be facing the camera (ideally front-facing or slight angle)
- Good lighting without harsh shadows
- High enough resolution to see facial details
- No obstructions (sunglasses, masks, heavy filters)

**The Process:**
1. Click the upload area
2. Select your photo (supports JPG, PNG, HEIC)
3. System automatically calibrates and locks your identity
4. You can then generate unlimited stickers with that locked identity

**Credit Cost:**
- Initial calibration: **1 credit** (one-time per photo)
- Subsequent generations use the same Identity Lock at no additional calibration cost

### Mode 2: From Text (Text-to-Image)

**What It Does:**
Creates imaginary characters based on text descriptions - no photo needed.

**When to Use:**
- You want to create fictional characters
- You don't have a photo available
- You want abstract or conceptual characters  
- You're creating brand mascots or avatars

**How It Works:**
1. Switch to "From Text" mode
2. In "Subject" field, describe the character (e.g., "A wise wizard cat")
3. In "Key Characteristics" field, add specific details (e.g., "wearing star-patterned robes, has green eyes")
4. Select expressions and styles
5. Generate

**Limitations:**
- No Identity Lock (each generation may look slightly different)
- Less control over specific facial features  
- Cannot guarantee exact likeness across multiple generations
- Better for fantasy/cartoon characters than realistic people

**Credit Cost:**
- No calibration cost
- Each sticker in pack costs 1 credit

### Switching Between Modes

You can freely switch modes at any time:
- Switching FROM "Image" TO "Text": Your calibrated identity is preserved but not used
- Switching FROM "Text" TO "Image": You need to upload and calibrate a photo

---


## 5. IDENTITY LOCK SYSTEM: THE MAGIC

### What is Identity Lock?

Identity Lock is the proprietary technology that makes AI Sticker Studio unique. It's a sophisticated AI system that analyzes your facial structure and preserves your exact likeness across all generated stickers, regardless of expression, pose, or artistic style.

**The Problem It Solves:**
Without Identity Lock, each AI-generated image would look like a different person. Your "laughing" sticker might have different eyes than your "wink" sticker. Identity Lock ensures ALL your stickers look unmistakably like YOU.

### How Identity Lock Works (V2 System)

The system uses a **4-step forensic analysis process**:

#### **Step 1: Upload & Initial Analysis**
When you upload a photo:
- System performs immediate subject detection
- Checks photo quality and lighting
- Warns you if photo may produce suboptimal results

#### **Step 2: Neutral Reference Generation**
The AI creates a "forensic faceprint":
- Removes your current expression and pose
- Creates perfectly forward-facing, neutral portrait
- Removes accessories (glasses, hats, jewelry)
- Applies even studio lighting
- **Purpose**: Creates emotionless baseline for comparison

#### **Step 3: Biometric Profile Extraction**
The AI performs forensic facial analysis extracting:

**Bone Structure:**
- Face shape (oval, round, square, heart, diamond)
- Jawline prominence and angle
- Cheekbone height and prominence
- Chin shape and projection
- Forehead height and width

**Eye Biometrics:**
- Iris color (precise, not just "brown")
- Eye shape (almond, round, hooded, upturned, downturned)
- Pupillary distance (wide-set, average, close-set)
- Eyelid type (monolid, single, double, hooded)
- Eyebrow shape and thickness

**Nose Structure:**
- Bridge width and height
- Nostril shape
- Tip shape
- Overall size

**Mouth Features:**
- Upper and lower lip fullness
- Cupid's bow definition
- Mouth width

**Distinctive Features:**
- Dimples (location if present)
- Hair style, length, color, texture
- Earrings (type, location, size)
- Tattoos (exact location and design)
- Piercings
- Markers (moles, freckles, scars with exact locations)

**Skin Tone:**
- Base tone (fair, medium, tan, deep)
- Undertones (cool, warm, neutral)

#### **Step 4: Identity Fingerprint Creation**
The biometric profile is compressed into a compact "identity fingerprint" (max 150 words) that:
- Prioritizes most distinctive features
- Uses precise, measurable language
- Emphasizes features that survive style transformations
- Becomes the reference used in all generation prompts

### The Calibration Process

####  **Automatic Calibration** (Default & Recommended)

When you upload a photo, the system AUTOMATICALLY:
1. Deducts 1 credit
2. Performs all 4 analysis steps
3. Creates complete Identity Anchor
4. Auto-approves and locks identity
5. You're ready to generate immediately

**Time**: 10-15 seconds  
**Cost**: 1 credit (one-time)  
**User Action**: None required!

#### **Manual Calibration** (Legacy Method)

Available if you prefer verification step:
1. Upload photo
2. Click "Calibrate" button
3. System shows you "Before" (your photo) vs "After" (AI's neutral faceprint)
4. You approve or reject
5. If approved, identity is locked

**Time**: 15-20 seconds  
**Cost**: 1 credit  
**Advantage**: You can verify accuracy before locking

### Identity Lock Strength Levels

Once calibrated, you can choose validation strictness:

####  **Off - V1 System (Fastest)**
- Uses basic identity template
- No validation or retry
- Fastest generation
- Good for: Quick iterations, less critical accuracy

####  **Standard - V2 System (Recommended)**
- Uses complete Identity Anchor with neutral reference
- Validates each generated sticker (similarity score 85%+)
- 1 generation attempt per sticker
- Auto-retries if validation fails
- **Best balance of speed and accuracy**

####  **Maximum - V2 System (Highest Accuracy)**
- Same as Standard but allows up to 3 attempts per sticker
- Will retry up to 2 times if validation fails
- Ensures 85%+ similarity score
- Slower but produces most consistent results
- Good for: Final packs, important projects

### Understanding the Identity Lock Status Indicator

In Section 2, you'll see a status box showing:

**"Not Calibrated"** (Yellow)
- No photo uploaded yet, OR
- Photo uploaded but calibration hasn't run
- You cannot generate stickers yet

**"Processing..."** (Purple, Animated)
- Photo is being analyzed
- System is creating your Identity Anchor
- Wait for this to complete

**"Calibrating..."** (Purple, Animated)
- AI is performing the 4-step analysis
- Usually takes 10-15 seconds
- Don't close the browser!

**"âœ“ Locked"** (Green)
- Identity successfully calibrated and locked
- You can now generate stickers
- This identity will be used for all generations

---


## 6. EXPRESSION SELECTION GUIDE

### Overview

The Expression Library contains 36+ pre-designed expressions, poses, and activities. Each expression has been carefully crafted with detailed AI prompts to ensure consistent, high-quality results.

### How to Select Expressions

1. **Navigate to Section 3: Expression & Pose**
2. **View the Expression Grid**: Icons representing each expression
3. **Click to Select**: Expression gets purple highlight ring
4. **Click Again to Deselect**: Ring disappears
5. **Multiple Selection**: Click as many as you want (for static packs)
6. **Single Selection**: Animated stickers can only use ONE expression

### Expression Categories

Expressions are organized into 8 categories for easy browsing:

---

### CATEGORY: Greetings (11 Expressions)

**HEY**
- **Icon**: Sparkle/wave
- **What it generates**: Enthusiastic wave with big, friendly smile, one hand raised
- **Best for**: General greetings, starting conversations
- **Tip**: Works great in vibrant cartoon styles

**Nod**
- **What it generates**: Slight, respectful nod with polite smile
- **Best for**: Professional acknowledgments, subtle greetings
- **Tip**: Excellent for photorealistic or 3D render styles

**High Five**
- **What it generates**: Hand raised high for energetic high-five, excited expression
- **Best for**: Celebrations, enthusiastic responses
- **Composition**: Use Half-Body or Full-Body to show raised hand

**FISTBUMP**
- **What it generates**: Fist extended forward for cool fistbump
- **Best for**: Casual, friendly interactions
- **Composition**: Headshot/Bust works well (fist in foreground)

**Morning**
- **What it generates**: Cheerful smile while holding steaming coffee cup
- **Best for**: Morning messages, coffee lovers
- **Includes**: Default speech bubble "Morning!"

**Good Afternoon**
- **What it generates**: Pleasant wave with relaxed, happy smile
- **Best for**: Midday greetings
- **Includes**: Speech bubble "Good Afternoon"

**Good Evening**
- **What it generates**: Calm, warm smile with soft twilight vibe
- **Best for**: Evening greetings, calm moods
- **Includes**: Speech bubble "Good Evening"

**Love You**
- **What it generates**: Heart shape made with hands over chest, warm loving expression
- **Best for**: Romantic messages, family affection
- **Includes**: Speech bubble "Love You"
- **Composition**: Use Half-Body to show both hands forming heart

**Love you more**
- **What it generates**: Same as "Love You" but more effusive with blushing cheeks
- **Best for**: Playful romantic competition
- **Includes**: Speech bubble "Love you more"

**Hi Beautiful**
- **What it generates**: Charming wink with confident smile
- **Best for**: Flirty greetings
- **Includes**: Speech bubble "Hi Beautiful"

**Hi Love**
- **What it generates**: Gentle wave with soft, loving expression
- **Best for**: Intimate greetings
- **Includes**: Speech bubble "Hi Love"

---

### CATEGORY: Gestures (5 Expressions)

**(Pose from image)**
- **Special Expression**: Uses the EXACT pose from your uploaded photo
- **How it works**: AI preserves your original pose and expression
- **Best for**: When your uploaded photo already has perfect pose
- **Note**: Only available in Image-to-Image mode
- **Credit Cost**: Cheaper! Only 1 credit (not affected by pack size)

**Thumbs Up**
- **What it generates**: Enthusiastic thumbs up, confident smile, arm extended
- **Best for**: Approval, agreement, positive feedback
- **Composition**: Half-Body recommended to show full arm extension

**PEACE SIGN**
- **What it generates**: Classic V-sign near face with cheerful expression
- **Best for**: Casual greetings, playful moods
- **Tip**: Works amazingly in Kawaii or Chibi styles

**Heart-hands**
- **What it generates**: Perfect heart shape formed with both hands
- **Best for**: Love, appreciation, support messages
- **Composition**: Half-Body or Full-Body to show both hands

---

### CATEGORY: Emotions (4 Expressions)

**Laughing**
- **What it generates**: Hysterical laughter, head thrown back, eyes squeezed shut, cartoon tears of joy
- **Best for**: Extremely funny reactions
- **Style Note**: Cartoon Vector excels with this expression

**In Love**
- **What it generates**: Large glowing heart eyes, blissful smile, hands clasped to chest
- **Best for**: Romantic feelings, adoration
- **Style Tip**: Kawaii and Chibi styles make this extra cute

**Sad**
- **What it generates**: Downcast look, quivering frown, large cartoon tears
- **Best for**: Sympathy, disappointment, sad reactions
- **Note**: AI adds dramatic teardrop effects

**Angry**
- **What it generates**: Furrowed brows, scowl, clenched teeth, steam from ears
- **Best for**: Frustration, annoyance (in playful way)
- **Style Tip**: Pop art and Cartoon Vector make this comically exaggerated

---

### CATEGORY: Reactions (5 Expressions)

**Facepalm**
- **What it generates**: Palm pressed to forehead in disbelief, eyes closed in exasperation
- **Best for**: "I can't believe this" moments
- **Composition**: Bust or Half-Body to show full arm

**Shrug**
- **What it generates**: Shoulders raised, palms up, puzzled expression
- **Best for**: "I don't know" / indifference
- **Composition**: Half-Body or Full-Body essential to show shoulders

**Mind Blown**
- **What it generates**: Top of head exploding with energy/stars, shocked face
- **Best for**: Amazing revelations, shocking news
- **Style Tip**: WPAP and Pop styles make explosions dramatic

**Eating Popcorn**
- **What it generates**: Intently watching while eating from large popcorn bucket
- **Best for**: Watching drama unfold, spectating
- **Composition**: Half-Body to show popcorn bucket

**Sipping Tea**
- **What it generates**: Sly side-eye while sipping tea, pinky extended, knowing smirk
- **Best for**: Gossip, shade, sassy responses
- **Cultural Note**: Popular internet meme expression

---

### CATEGORY: Poses (5 Expressions)

**Wink**
- **What it generates**: Playful wink with one eye, confident lopsided smile
- **Best for**: Flirty responses, playful acknowledgments
- **Tip**: Works in all styles

**Smirk**
- **What it generates**: Mischievous confident smirk, one eyebrow raised
- **Best for**: Sarcasm, knowing confidence
- **Style Tip**: Photorealistic and 3D Render capture subtlety best

**Thinking**
- **What it generates**: Finger on chin, looking upward, lightbulb above head
- **Best for**: Contemplation, "hmm" moments
- **Note**: AI adds lightbulb as visual element

**Heroic Pose**
- **What it generates**: Superhero stance, hands on hips, confident expression
- **Best for**: Motivation, achievement, confidence
- **Composition**: Full-Body essential for full superhero effect

**Crossed Arms**
- **What it generates**: Arms crossed over chest, serious/skeptical expression
- **Best for**: Skepticism, confidence, "not impressed"
- **Composition**: Half-Body or Full-Body to show crossed arms

---

### CATEGORY: Activities (4 Expressions)

**Working on Laptop**
- **What it generates**: Focused typing with concentration, screen glow on face
- **Best for**: "I'm busy", work mode
- **Composition**: Half-Body to show laptop

**Gaming**
- **What it generates**: Intense game-play with controller and headphones
- **Best for**: Gamers, "gaming session" status
- **Note**: AI adds gaming accessories

**Celebrating**
- **What it generates**: Arms raised triumphantly, throwing confetti, huge smile
- **Best for**: Victories, achievements, parties
- **Composition**: Full-Body for maximum impact

**Reading Book**
- **What it generates**: Engrossed in open book, thoughtful expression
- **Best for**: "Do not disturb", studious mode
- **Note**: AI generates detailed book prop

---

### CATEGORY: Expressions of Surprise (2 Expressions)

**Gasp**
- **What it generates**: Dramatic gasp, hand over mouth, wide eyes, body recoiling
- **Best for**: Shocking news, surprise reveals
- **Composition**: Bust or Half-Body to show hand

**Shocked**
- **What it generates**: Jaw-dropped, eyes popping out cartoonishly, frozen stiff
- **Best for**: Extreme surprise, can't-believe-it moments
- **Style Tip**: Cartoon styles make this hilariously exaggerated

---

### CATEGORY: Props & Items (5 Expressions)

**Deal With It**
- **What it generates**: Pixelated sunglasses sliding onto face, smug expression
- **Best for**: Confidence, dismissive responses
- **Cultural Note**: Classic internet meme

**Coffee**
- **What it generates**: Holding steaming mug close to face, eyes closed, content
- **Best for**: Coffee lovers, morning rituals
- **Vs. "Morning"**: This focuses on coffee appreciation, not greeting

**Holds Sign**
- **What it generates**: Holding blank sign/placard, neutral inviting expression
- **Best for**: Custom messages (add speech bubble!)
- **Tip**: Perfect for announcements

**Punch-Forward**
- **What it generates**: Fist punching toward camera with motion lines, determined face
- **Best for**: Determination, fighting spirit, power
- **Style Tip**: Comic book styles (Pop, WPAP) enhance impact

**WAZZZAAA**
- **What it generates**: Iconic "Wassup" expression - tongue out, eyes wide
- **Best for**: Casual greetings, goofy vibes
- **Cultural Note**: Reference to classic commercial

---

### Multi-Expression Selection Strategy

#### **For Static Packs:**

**Complementary Pairs:**
- HEY + Peace Sign (friendly duo)
- Thumbs Up + Wink (confident pair)
- Laughing + In Love (positive emotions)
- Sad + Angry (emotion range)

**Themed Sets:**
- Coffee Lover: Morning + Coffee + Sipping Tea + Working on Laptop
- Gamer Pack: Gaming + Celebrating + Facepalm + Deal With It
- Romantic: Love You + Love you more + Heart-hands + In Love
- Professional: Nod + Thumbs Up + Thinking + Working on Laptop

#### **For Animated Stickers:**
Remember: **Only ONE expression allowed** for animated format!

**Best Expressions for Animation:**
- Laughing (tears animate beautifully)
- Celebrating (confetti animates)
- Working on Laptop (typing motion)
- Gaming (controller motion)
- Mind Blown (explosion effects)

---

### Adding Speech Bubbles

Any expression (except "Pose from image") can have a custom speech bubble!

**How to Add:**
1. Select an expression (it gets purple ring)
2. Look for small blue icon in top-right corner of expression tile
3. Click the icon
4. Enter your custom text in the modal
5. Click "Set Text"

**Speech Bubble appears as:**
- Blue icon background when text is set
- Gray icon background when no text
- Text will appear in generated sticker

**Removing Speech Bubbles:**
1. Click the blue icon
2. Delete all text in the modal
3. Click "Set Text"

**Tips:**
- Keep text short (1-5 words work best)
- Emojis are supported!
- Consider sticker size when adding long text

---


## 7. ARTISTIC CUSTOMIZATION

### The Style System

AI Sticker Studio offers unprecedented artistic control through a **compatibility-based style system**. Not all combinations make artistic sense (e.g., photorealistic images don't have "bold outlines"), so the system intelligently filters incompatible options.

### Section 4 Controls Explained

**Output Format** â†’ **Artistic Style** â†’ **Color Palette** â†’ **Line Style** â†’ **Shading Style** â†’ **Composition**

#### **1. Output Format**

**Static (Image)**
- Generates PNG images with transparent backgrounds
- Can select multiple expressions (up to pack size)
- Supports all artistic styles
- File size: Small (typically 100-500KB per sticker)
- Use for: Messaging apps, social media, printing

**Animated (Video)**
- Generates MP4 video files with looping animation
- Can select ONLY ONE expression  
- Supports all artistic styles + animation effects
- File size: Larger (typically 2-5MB)
- Use for: Animated stickers, GIF replacements, dynamic content

#### **2. Artistic Style** (15 Options)

**Cartoon Vector** â­ MOST POPULAR
- **Description**: Clean, vibrant vector art with smooth gradients
- **Compatible Shading**: Cel-shading, Flat, Gradient
- **Compatible Lines**: Bold, Thin, Smooth
- **Best for**: General-purpose stickers, messaging apps
- **Characteristics**: Professional, versatile, high contrast
- **Example Uses**: WhatsApp stickers, Telegram packs

**Sticker Style**
- **Description**: Purpose-built for sticker format with thick outlines
- **Compatible Shading**: Gradient, Cel-shading
- **Compatible Lines**: Bold, Smooth
- **Best for**: True sticker aesthetic
- **Characteristics**: Bold outlines, punchy colors, high readability

**Kawaii**
- **Description**: Cute Japanese-inspired style with big eyes and soft features
- **Compatible Shading**: Gradient, Cel-shading, Flat
- **Compatible Lines**: Smooth, Thin, Bold
- **Best for**: Cute characters, anime fans
- **Characteristics**: Oversized eyes, small nose/mouth, pastel-friendly
- **Tip**: Combine with Pastel palette for maximum cuteness

**Chibi**
- **Description**: Super-deformed characters with large heads, tiny bodies
- **Compatible Shading**: Cel-shading, Gradient
- **Compatible Lines**: Bold, Smooth
- **Best for**: Adorable, expressive characters
- **Characteristics**: 1:2 or 1:3 head-to-body ratio
- **Note**: Best with Half-Body or Full-Body composition

**3D Render**
- **Description**: Modern CGI-quality 3D rendering
- **Compatible Shading**: Gradient (only option - 3D needs depth)
- **Compatible Lines**: None (3D objects don't have outlines)
- **Best for**: Professional, modern aesthetic
- **Characteristics**: Realistic lighting, depth, shadows
- **Tip**: Great for photorealistic + stylized hybrid

**Lineart**
- **Description**: Clean line drawings with minimal or no fill
- **Compatible Shading**: None (lineart doesn't use shading)
- **Compatible Lines**: Thin, Bold, Hand-drawn, Smooth
- **Best for**: Minimalist aesthetic, coloring book style
- **Characteristics**: Elegant, timeless, versatile
- **Note**: Works beautifully in monochrome palette

**Flat**
- **Description**: Completely flat colors with no gradients or depth
- **Compatible Shading**: Flat (only option)
- **Compatible Lines**: Smooth, Bold, Thin, None
- **Best for**: Modern, minimalist designs
- **Characteristics**: No shadows, solid colors, clean
- **Similar to**: Material Design, modern UI icons

**WPAP** (Wedha's Pop Art Portrait)
- **Description**: Indonesian geometric pop art with angular facets
- **Compatible Shading**: Flat (only option)
- **Compatible Lines**: Bold (only option)
- **Best for**: Bold, striking, artistic statements
- **Characteristics**: Geometric shapes, bold colors, angular
- **Difficulty**: Complex style - results may vary

**Pop**
- **Description**: Pop art style (Warhol-inspired)
- **Compatible Shading**: Flat, Cel-shading
- **Compatible Lines**: Bold, Thin
- **Best for**: Retro vibes, bold artistic expression
- **Characteristics**: High contrast, vibrant, graphic

**Tritone**
- **Description**: Three-color limited palette style
- **Compatible Shading**: Flat
- **Compatible Lines**: Smooth, Bold, None
- **Best for**: Vintage posters, limited color aesthetic
- **Note**: AI automatically selects 3 harmonious colors

**Dotwork / Stippling**
- **Description**: Image composed of thousands of tiny dots
- **Compatible Shading**: None (dots create depth)
- **Compatible Lines**: Thin (only option)
- **Best for**: Artistic, tattoo-style aesthetic
- **Characteristics**: Intricate, meditative, unique
- **Warning**: Complex - may require higher resolution

**Watercolor**
- **Description**: Soft, flowing watercolor painting aesthetic
- **Compatible Shading**: Gradient, None
- **Compatible Lines**: Thin, Hand-drawn, None
- **Best for**: Soft, artistic expression
- **Characteristics**: Flowing edges, color bleeding, organic

**Oil Painting**
- **Description**: Classical oil painting with visible brush strokes
- **Compatible Shading**: Gradient
- **Compatible Lines**: None, Smooth, Hand-drawn, Bold
- **Best for**: Fine art aesthetic, classical portraits
- **Characteristics**: Rich colors, texture, painterly

**Pencil Sketch**
- **Description**: Hand-drawn pencil sketch aesthetic
- **Compatible Shading**: None (pencil strokes create depth)
- **Compatible Lines**: Hand-drawn, Thin
- **Best for**: Raw, artistic, sketch-like feel
- **Characteristics**: Sketchy, organic, artistic

**Photorealistic**
- **Description**: Hyper-realistic CGI rendering
- **Compatible Shading**: Gradient (only option)
- **Compatible Lines**: None (photos don't have outlines)
- **Best for**: Maximum realism, professional portraits
- **Characteristics**: Realistic skin, lighting, depth
- **Note**: May look too realistic for casual stickers

---

#### **3. Color Palette** (3 Options)

**Vibrant** (Default & Recommended)
- Bold, saturated, punchy colors
- High contrast and energy
- Best for: Most sticker styles, high visibility
- Works with: All styles

**Pastel**
- Soft, muted, gentle colors
- Calming aesthetic
- Best for: Kawaii, Chibi, Watercolor styles
- Creates: Dreamy, soft, cute vibe

**Monochrome**
- Single color in various shades (usually purple/gray)
- Elegant, timeless
- Best for: Lineart, Pencil Sketch, artistic projects
- Creates: Sophisticated, minimal aesthetic

---

#### **4. Line Style** (5 Options)

**Bold**
- Thick, prominent outlines
- High contrast with fill
- Best for: Cartoon Vector, Sticker Style, WPAP
- Creates: Clear, readable, bold aesthetic

**Thin**
- Delicate, precise lines
- Subtle outline definition
- Best for: Lineart, Pencil Sketch, Kawaii
- Creates: Elegant, detailed look

**Hand-drawn**
- Organic, slightly imperfect lines
- Mimics human drawing
- Best for: Watercolor, Pencil Sketch, Oil Painting
- Creates: Artistic, warm, human feel

**Smooth**
- Perfect, computer-precise lines
- Clean vector quality
- Best for: Cartoon Vector, Flat, Pop
- Creates: Professional, polished look

**None**
- No outlines/lines
- Best for: Photorealistic, 3D Render, Oil Painting
- Creates: Realistic, painterly aesthetic

**Note:** Some styles auto-select compatible line style. If dropdown is disabled, only one option is valid for your chosen style.

---

#### **5. Shading Style** (4 Options)

**Flat**
- No shading or depth
- Solid color fills only
- Best for: Flat, WPAP, Tritone, Pop
- Creates: Modern, graphic, bold look

**Cel-shading**
- Anime-style shading with hard edges
- 2-3 distinct color zones per area
- Best for: Cartoon Vector, Kawaii, Chibi, Pop
- Creates: Anime/cartoon aesthetic with depth

**Gradient**
- Smooth color transitions
- Realistic depth simulation
- Best for: 3D Render, Photorealistic, Oil Painting, Watercolor
- Creates: Depth, dimension, realism

**None**
- No shading technique applied
- Best for: Lineart, Pencil Sketch, Dotwork
- Creates: Sketch-like, minimal aesthetic

**Note:** Like line styles, incompatible options are auto-filtered.

---

#### **6. Composition** (3 Options)

**Headshot / Bust** (Shoulders up)
- Shows: Face, neck, shoulders
- Best for: Facial expression focus
- File size: Smallest
- Detail level: Highest on face
- **Warning**: Some expressions require Half-Body or Full-Body to show hands/arms (system warns you)

**Half-Body** (Waist up) â­ RECOMMENDED
- Shows: Face, arms, torso
- Best for: Most expressions, balanced framing
- File size: Medium
- Detail level: Good balance
- Works with: All expressions

**Full-Body** (Head to toe)
- Shows: Entire character
- Best for: Heroic Pose, Celebrating, poses requiring full stance
- File size: Same as others (character scaled down)
- Detail level: Less facial detail, more scene
- Creates: Dynamic, action-oriented stickers

---

### Style Compatibility System

The system uses a smart compatibility matrix (STYLE_COMPATIBILITY constant) that automatically:
1. Filters incompatible line styles based on chosen artistic style
2. Filters incompatible shading styles
3. Disables dropdowns when only 1 option is valid
4. Prevents artistic incoherence

**Example:**
- Choose "Photorealistic" â†’  Line Style auto-sets to "None" (photos don't have outlines)
- Choose "Lineart" â†’ Shading auto-sets to "None" (lineart doesn't use shading)

**You cannot create:**
- Photorealistic image with Bold outlines (makes no sense)
- Lineart with Cel-shading (contradictory)
- 3D Render with Hand-drawn lines (incompatible concepts)

This **prevents bad prompts** and ensures every combination produces coherent results!

---


## 8. OUTPUT FORMATS: STATIC VS ANIMATED

### Static Stickers (Images)

**Format**: PNG with transparent background  
**Model Used**: `gemini-2.5-flash-image-preview`  
**Generation Time**: 5-10 seconds per sticker  
**File Size**: 100-500KB per sticker

**Advantages:**
- âœ… Generate multiple expressions in one pack (up to 20)
- âœ… Smaller file sizes
- âœ… Compatible with all messaging platforms
- âœ… Faster generation
- âœ… Lower credit cost per sticker

**Best For:**
- Messaging app sticker packs
- Social media reactions
- Print purposes
- Discord, Slack emojis

**Pack Generation Logic:**
- Select 4 expressions, set pack size to 8 â†’ AI adds 4 random expressions
- Select 8 expressions, set pack size to 4 â†’ Only first 4 generated
- Pack size determines credit cost (1 credit per sticker)

---

### Animated Stickers (Videos)

**Format**: MP4 video file (2-3 second loop)  
**Model Used**: `veo-2.0-generate-001`  
**Generation Time**: 2-3 minutes (includes rendering + download)  
**File Size**: 2-5MB

**Advantages:**
- âœ… Eye-catching, dynamic movement
- âœ… Seamless looping animations
- âœ… Stand out in conversations
- âœ… Professional quality motion graphics

**Limitations:**
- âš ï¸ Only ONE expression per generation
- âš ï¸ Longer generation time (2-3 minutes)
- âš ï¸ Larger file sizes
- âš ï¸ May not work in all messaging platforms
- âš ï¸ Fixed credit cost (1 credit regardless of settings)

**Best For:**
- Telegram animated stickers
- Discord animated emojis
- Social media stories
- Eye-catching reactions

---

### Animation Styles (9 Options + Custom)

**Subtle Movement**
- Gentle breathing motion, slight head bob
- Natural, realistic movement
- Best for: Realistic styles, professional use

**Bouncing**
- Character bounces up and down rhythmically
- Energetic and playful
- Best for: Happy expressions, celebrations

**Wiggle**
- Side-to-side wiggling motion
- Cute and attention-grabbing
- Best for: Kawaii, Chibi styles

**Spinning**
- Full 360Â° rotation
- Dynamic and bold
- Best for: Celebrating, Deal With It expressions

**Shimmering**
- Sparkle/glitter effects overlay
- Magical, eye-catching
- Best for: In Love, positive emotions

**Floating**
- Gentle up-and-down floating motion
- Dreamy, ethereal
- Best for: Calm expressions, artistic styles

**Pulsing**
- Growing and shrinking rhythmically
- Attention-grabbing
- Best for: Mind Blown, emphasis expressions

**Glitching**
- Digital glitch effects, color separation
- Cyberpunk, tech aesthetic
- Best for: Modern, edgy styles

**Zoom In-Out**
- Camera zooms in and out
- Dramatic effect
- Best for: Shocked, Gasp, emphasis

**Custom**
- Write your own animation prompt!
- Examples:
  - "Waving a tiny flag"
  - "Confetti falling from above"
  - "Gentle head tilt left and right"
  - "Eyes blinking slowly"

---

### Advanced Animation Settings (Optional)

Located under "Advanced Animation Settings" collapsible section:

**Speed**
- 0.5x: Slow, dramatic
- 1x: Normal (recommended)
- 1.5x: Energetic
- 2x: Fast, hyperactive

**Loop Style**
- Infinite: Loops forever (standard for stickers)
- Once: Plays once then freezes
- Bounce: Plays forward, then backward

**Easing Function**
- Linear: Constant speed (robotic)
- Ease-in: Starts slow, ends fast
- Ease-out: Starts fast, ends slow (most natural)
- Ease-in-out: Smooth start and end

**When to Adjust:**
- Speed: Match the energy of your expression
- Loop Style: Use "Bounce" for back-and-forth motions
- Easing: Use "Ease-out" for most natural feel

---


## 9. PACK & QUALITY SETTINGS

### Pack Size (Static Stickers Only)

**Available Options**: 1, 2, 4, 8, 12, 16, 20

**How It Works:**
- Pack Size = Number of stickers generated
- Pack Size = Credit cost (1 credit per sticker)
- Example: Pack size 8 = 8 stickers generated = 8 credits

**Special Rules:**

**When "(Pose from image)" is selected:**
- Pack size is DISABLED (locked to 1)
- Cost is always 1 credit
- Reason: This expression uses your exact photo pose

**When selecting fewer expressions than pack size:**
- Example: Select 2 expressions, pack size is 8
- AI generates your 2 selections first
- Then AI randomly selects 6 more expressions to complete the pack
- You get 8 total stickers (2 requested + 6 random)

**Strategy:**
- **Small Packs (1-4)**: Testing styles, specific needs
- **Medium Packs (8-12)**: Good variety, balanced cost
- **Large Packs (16-20)**: Maximum variety, best value per sticker

### Resolution

**Available Options**: 512px, 768px, 1024px

**512px** (Low)
- Fastest generation
- Smallest file sizes
- Good for: Web use, messaging apps
- Quality: Good for small display sizes

**768px** (Medium) â­ RECOMMENDED
- Balanced generation speed
- Moderate file sizes
- Good for: Most uses, social media
- Quality: Sharp on most screens

**1024px** (High)
- Slower generation
- Larger file sizes
- Good for: Printing, large displays, archival
- Quality: Professional, maximum detail

**Note:** Resolution doesn't affect credit cost, only generation time and file size.

---

## 10. GENERATION PROCESS EXPLAINED

### The Complete Generation Workflow

#### **Phase 1: Pre-Flight Checks**

When you click "Generate", the system performs validation:

1. **Credit Check**: Do you have enough credits?
   - Cost calculation based on output format and pack size
   - If insufficient, shows error: "Insufficient credits. Needs X."

2. **Identity Check** (Image-to-Image mode only):
   - Is Identity Lock confirmed?
   - If not: Shows "Please upload and calibrate an image first"

3. **Expression Check**:
   - At least one expression selected?
   - If not: Shows "Please select at least one expression"

4. **Confirmation Dialog**:
   - Title: "Confirm Sticker Generation" or "Confirm Animation Generation"
   - Shows exactly what will be generated
   - Shows exact credit cost
   - Buttons: Cancel or Confirm

---

#### **Phase 2: Credit Deduction & Initialization**

After you click "Confirm":

1. **Credits Deducted Immediately**
   - Full cost deducted upfront
   - Shows in activity log: "Generation started"
   - Credit transaction logged

2. **State Changes**:
   - `isLoading` set to `true`
   - Previous results cleared
   - Error state cleared
   - Loading message displayed

3. **Expression List Built**:
   - Your selected expressions compiled
   - If pack size > selections, random expressions added
   - List trimmed to exactly pack size
   - "(Pose from image)" gets your photo's pose description injected

---

#### **Phase 3: AI Generation**

**For Static Stickers:**

Sequential generation (one at a time):
1. "Generating sticker 1 of 4: HEY..."
2. AI prompt constructed with:
   - Expert persona ("world-class digital illustrator")
   - Primary directive (preserve identity)
   - Your Identity Lock data
   - Expression description
   - All style settings
3. API call to Gemini
4. Image received and validated
5. Repeat for next expression

**Identity Lock V2 Process** (if enabled):
- Each sticker goes through validation
- AI compares generated sticker to neutral reference
- Similarity score calculated (0-100)
- If score < 85%, auto-retry (up to max attempts)
- Validation results stored with each sticker

**For Animated Stickers:**

Different workflow (video generation):
1. "Generating animation... 0%"
2. Submits video generation job to Veo API
3. Polls for completion every 10 seconds
4. Shows progress: "Generating animation... 45%"
5. When complete, downloads video file
6. "Downloading and finalizing animation..."
7. Converts to data URL

**Note:** Animation can be cancelled mid-generation (credits refunded)

---

#### **Phase 4: Results & Collection**

**On Success:**
1. Generated stickers appear in preview area
2. Loading state cleared
3. Success message in activity log
4. All results automatically saved to Collection
5. Results added to "Recent Generations"
6. Metadata stored:
   - Timestamp
   - Credit cost
   - Generation time
   - Model used
   - Validation results (if V2)
   - All settings used

**On Failure:**
1. Error message displayed
2. Credits automatically refunded (full amount)
3. Refund logged in activity
4. Failure result stored in collection (for debugging)
5. Error details saved

---

#### **Phase 5: Post-Generation Actions**

**Quick Actions** (on each sticker):
- **Download**: Save as PNG/MP4 to your device
- **Edit**: Open in Post-Processing Studio (1 credit per edit)
- **View**: Full-screen viewer with zoom
- **Drag to Collection**: Auto-saves for later

**Batch Actions**:
- Download entire pack as ZIP file
- Add all to character library
- Share settings with others

---

## 11. ADVANCED FEATURES

### Identity Lock V2 vs V1

**V1 System** (Legacy):
- Uses basic JSON identity template
- No validation
- No retry logic
- Faster but less consistent

**V2 System** (Current):
- Uses Identity Anchor (neutral reference + biometric profile + fingerprint)
- Validates each generation
- Auto-retry on validation failure
- Slower but highly consistent

**When V2 Runs:**
- Identity Lock Strength set to "Standard" or "Maximum"
- Only in Image-to-Image mode
- Automatically enabled after calibration

**Validation Process:**
1. Generate sticker
2. AI compares to neutral reference
3. Analyzes: face shape, eyes, nose, mouth, distinctive features
4. Calculates similarity score (0-100)
5. If score >= 85%: Valid âœ“
6. If score < 85%: Retry (if attempts remaining)

**Validation Results Shown:**
- Green checkmark: Valid (score >= 85%)
- Yellow warning: May have inconsistencies
- View validation details in Collection modal

---

### Identity Template Editor

**What It Is:**
A JSON editor showing your complete biometric profile.

**How to Access:**
1. Upload and calibrate a photo
2. Scroll down in Section 2
3. Click "Show/Edit Identity Template"

**What You Can Do:**
- View detailed facial analysis
- Manually edit any field
- Fix AI mistakes
- Add custom details
- Save changes

**Common Edits:**
- Hair color if AI got it wrong
- Add missing distinctive features
- Correct gender/age assessments
- Enhance specific details

**Warning:** Manual edits directly affect generation quality. Only edit if you know what you're doing!

---

### Character Creation from Stickers

**What It Does:**
Converts a generated sticker into a reusable Character for the Wallpaper Studio.

**How to Use:**
1. Generate a sticker you love
2. Click "+" button on the sticker
3. Enter character name
4. Character saved to library
5. Can now be used in Wallpaper Studio

**What Gets Saved:**
- The sticker image
- Identity template
- Name
- All biometric data
- Generation settings

**Why This Is Useful:**
- Reuse calibrated identity in wallpapers
- Build character library
- No need to re-calibrate
- Mix characters in wallpaper scenes

---

### Collection Integration

**Drag & Drop from Collection:**
1. Open Collection (button in header)
2. Find a previously generated sticker
3. Drag it to the upload area in Sticker Studio
4. Identity Lock automatically restored
5. You can now generate more stickers with that identity

**Benefits:**
- No re-calibration needed
- Instant identity restoration
- Use previous successful calibrations
- Build on past work

---

### Negative Prompts (Hidden Feature)

The system automatically applies negative prompts to prevent:
- Blurry images
- Low quality
- Text/watermarks
- Distortions
- Multiple faces (when one expected)

These are baked into the generation prompts and cannot be edited via UI (for safety).

---


## 12. TROUBLESHOOTING & FAQs

### Common Issues & Solutions

#### **Problem: "Your calibrated image has expired or could not be found"**

**Cause:** Image cache cleared or expired (browser storage limit reached)

**Solutions:**
1. Re-upload your photo
2. System will auto-calibrate again (costs 1 credit)
3. Or drag a previous sticker from Collection to restore identity

**Prevention:**
- Don't clear browser data
- Save important stickers to Collection
- Keep backup of original photos

---

#### **Problem: Generated stickers don't look like me**

**Possible Causes & Fixes:**

**Cause 1: Poor quality photo**
- Solution: Use clear, front-facing, well-lit photo
- Check: Can you clearly see all facial features in original?

**Cause 2: Identity Lock Strength too low**
- Solution: Change from "Off" to "Standard" or "Maximum"
- Location: Section 2, after calibration

**Cause 3: Incompatible artistic style**
- Solution: Try Cartoon Vector or Sticker Style first
- Some styles (WPAP, Dotwork) are harder for identity preservation

**Cause 4: Validation failed but went unnoticed**
- Solution: Check Collection, look for yellow warnings
- Re-generate with Maximum strength

---

#### **Problem: "Generation failed because the AI could not maintain identity consistency"**

**What This Means:**
Identity Lock V2 tried multiple times but couldn't achieve 85% similarity score.

**Solutions:**
1. **Try different style:**
   - Switch from complex (WPAP) to simple (Cartoon Vector)
   - Avoid Dotwork, Tritone for critical identity matches

2. **Increase Identity Lock Strength:**
   - Change to "Maximum" (allows 3 attempts)
   - Gives AI more chances to get it right

3. **Re-calibrate with better photo:**
   - Use clearer, better-lit photo
   - Ensure face is fully visible
   - Remove accessories

4. **Switch to V1 System:**
   - Set strength to "Off"
   - Faster but less validated
   - Good for testing

---

#### **Problem: Animation generation stuck at 95%**

**What's Happening:**
Video is rendering (final step takes longest)

**Normal Behavior:**
- Progress reaches 95% quickly
- Then stays there for 30-60 seconds
- This is normal! Final rendering is intensive

**If stuck > 3 minutes:**
1. Click "Cancel Generation"
2. Credits will be refunded
3. Try again with simpler animation style

---

#### **Problem: Pack size is disabled / can't change it**

**Cause**: You selected "(Pose from image)" expression

**Why:**
- This expression uses your exact photo
- Only makes sense as single sticker
- System auto-locks pack size to 1

**Solution:**
- Deselect "(Pose from image)" to unlock pack size
- Or keep it selected for cheap 1-credit generation

---

#### **Problem: Line Style / Shading Style dropdown is disabled**

**This is normal!**

**Cause**: Your chosen Artistic Style only supports one option

**Examples:**
- Photorealistic â†’ Line Style must be "None" (photos don't have outlines)
- Lineart â†’ Shading must be "None" (sketches don't have shading)
- WPAP â†’ Lines must be "Bold" (requirement of style)

**This is a feature, not a bug!** The system prevents incompatible combinations.

---

#### **Problem: Stickers have wrong colors / don't match palette**

**Cause**: Some styles override palette for artistic reasons

**Examples:**
- Tritone: Uses exactly 3 colors (ignores palette setting)
- Monochrome Lineart: Uses single color naturally
- Photorealistic: Uses natural skin tones (palette affects background/clothing)

**Expected Behavior:**
- Palette is a suggestion, not absolute rule
- AI prioritizes artistic coherence
- Skin tones stay realistic even with "Vibrant" palette

---

#### **Problem: Speech bubbles not appearing**

**Checklist:**
1. Did you set text for that expression? (blue icon = text set, gray = no text)
2. Is text very long? (may be cut off in final render)
3. Did generation complete successfully?
4. Are you viewing the right sticker?

**Note:** Speech bubbles are baked into the image during generation, not overlaid after.

---

### Frequently Asked Questions

**Q: Can I edit the Identity Template manually?**
A: Yes! Click "Show/Edit Identity Template" in Section 2 after calibration. Advanced users can fine-tune the AI's analysis.

**Q: How many times can I generate with one Identity Lock?**
A: Unlimited! One calibration (1 credit) unlocks infinite generations with that identity.

**Q: Can I use multiple photos of the same person?**
A: Yes, but you need to calibrate each photo separately (1 credit each). Slight angle/lighting differences create different Identity Locks.

**Q: Why does auto-calibration sometimes take longer?**
A: Complex photos (multiple people, poor lighting, accessories) take longer to analyze. Typical range: 10-20 seconds.

**Q: Can I cancel a generation in progress?**
A: Only for animated stickers! Static generation is fast and cannot be cancelled. Animation shows "Cancel Generation" button.

**Q: What happens to my credits if generation fails?**
A: Full automatic refund! All failures trigger immediate credit refund with log entry.

**Q: Can I download all my stickers at once?**
A: Yes! Collection modal has "Download Selected" feature. Select multiple, click download, get ZIP file.

**Q: Do stickers expire?**
A: Generated stickers stay in Collection permanently (stored in IndexedDB). Image cache may expire after long periods of inactivity.

**Q: Can I use these stickers commercially?**
A: That depends on your license agreement with Google Gemini API and image rights of the source photo.

**Q: Why do some animations not loop perfectly?**
A: This can happen with complex animation styles. Try "Subtle Movement" or "Bouncing" for best loops.

---


## 13. TIPS & BEST PRACTICES

### Photo Selection Guide

#### **Ideal Photo Characteristics:**

**Lighting:**
- âœ… Even, soft lighting on face
- âœ… No harsh shadows
- âœ… Natural daylight or ring light
- âŒ Backlit (face in shadow)
- âŒ One-sided lighting (half face dark)
- âŒ Direct flash (washed out)

**Pose & Angle:**
- âœ… Front-facing or slight angle (15-30Â°)
- âœ… Head fully in frame
- âœ… Natural, relaxed posture
- âŒ Profile (side view)
- âŒ Looking away from camera
- âŒ Tilted at extreme angles

**Expression:**
- âœ… Neutral or slight smile
- âœ… Natural, relaxed expression
- âŒ Extreme expressions (hard for AI to neutralize)
- âŒ Squinting
- âŒ Tongue out (confuses facial analysis)

**Quality:**
- âœ… Sharp focus on face
- âœ… High resolution (at least 800x800px)
- âœ… Minimal compression
- âŒ Blurry
- âŒ Low resolution
- âŒ Heavy filters/effects

**Obstructions:**
- âœ… Clear view of all facial features
- âŒ Sunglasses (hides eyes - critical for identity)
- âŒ Hats covering forehead/hair
- âŒ Hands covering parts of face
- âŒ Heavy makeup/filters altering face shape

**Examples:**
- âœ… GOOD: Passport photo style, professional headshot, casual selfie in good light
- âŒ BAD: Party photo with dim lighting, artistic portrait with shadows, heavily filtered social media photo

---

### Expression Selection Strategy

#### **For Your First Pack: Start Simple**
1. HEY (universal greeting)
2. Thumbs Up (positive reaction)
3. Laughing (joy)
4. Thinking (contemplation)

**Why:** These 4 cover most conversation scenarios and work in ALL styles.

#### **Building a Versatile Pack**

**The 8-Sticker Balanced Pack:**
1. HEY (greeting)
2. Thumbs Up (approval)
3. Laughing (joy)
4. Sad (sympathy)
5. Facepalm (frustration)
6. Thinking (contemplation)
7. Love You (affection)
8. Deal With It (confidence)

**Covers:** Greetings, emotions, reactions, attitudes

---

#### **Themed Pack Ideas**

**Office Worker Pack:**
- Working on Laptop
- Coffee
- Facepalm
- Celebrating
- Thinking
- Shrug
- Thumbs Up
- Gasp

**Gamer Pack:**
- Gaming
- Celebrating
- Angry
- Facepalm
- Deal With It
- Mind Blown
- WAZZZAAA
- Peace Sign

**Romantic Pack:**
- Love You
- Love you more
- Heart-hands
- In Love
- Hi Beautiful
- Hi Love
- Wink
- Morning

**Reaction Pack:**
- Laughing
- Shocked
- Gasp
- Mind Blown
- Facepalm
- Eating Popcorn
- Sipping Tea
- Deal With It

---

### Style Selection Guide

#### **For Maximum Identity Preservation:**
1. Cartoon Vector (best balance)
2. Sticker Style (designed for this)
3. Kawaii (good consistency)
4. 3D Render (realistic features)

**Avoid for first pack:**
- WPAP (too geometric)
- Dotwork (too abstract)
- Tritone (limited colors)

#### **For Specific Use Cases:**

**Messaging Apps (WhatsApp, Telegram):**
- Style: Cartoon Vector or Sticker Style
- Palette: Vibrant
- Resolution: 512px or 768px
- Composition: Headshot/Bust (focuses on face)

**Social Media Reactions:**
- Style: 3D Render or Photorealistic
- Palette: Vibrant
- Resolution: 1024px
- Composition: Half-Body (shows expressions with gestures)

**Artistic/Portfolio:**
- Style: Oil Painting, Watercolor, or Pencil Sketch
- Palette: Any (experiment!)
- Resolution: 1024px
- Composition: Depends on expression

**Professional/Work:**
- Style: Flat or 3D Render
- Palette: Monochrome
- Resolution: 1024px
- Composition: Headshot/Bust

---

### Optimizing for Speed

**Fastest Workflow:**
1. Use "(Pose from image)" expression (1 sticker = 1 credit = fastest)
2. Set Identity Lock Strength to "Off" (skips validation)
3. Use simple styles: Cartoon Vector, Flat
4. Use lower resolution: 512px
5. Avoid animations (2-3 minutes vs 10 seconds)

**Estimated Times:**
- Single static sticker (512px, V1): ~5 seconds
- 4-pack static (768px, V2 Standard): ~25-35 seconds
- 8-pack static (1024px, V2 Maximum): ~60-90 seconds
- Single animation: ~2-3 minutes

---

### Optimizing for Quality

**Highest Quality Workflow:**
1. Upload professional-quality photo (good lighting, sharp focus)
2. Manually verify calibration (approve faceprint)
3. Set Identity Lock Strength to "Maximum"
4. Choose proven styles: Cartoon Vector, Sticker Style, 3D Render
5. Use 1024px resolution
6. Select expressions carefully (avoid too many in one pack)
7. Use Vibrant palette for best color depth

**Quality Indicators:**
- Validation score: 95-100 = Perfect match
- Validation score: 85-94 = Strong match (acceptable)
- Validation score: <85 = AI will retry (if strength allows)

---

### Credit Management Tips

**Earning Credits:**
- Check if your instance provides free credits
- Some deployments refresh credits daily
- Plan generations around credit availability

**Spending Wisely:**
- **Calibration (1 credit):** Essential investment - unlocks unlimited generations
- **Testing styles:** Use pack size 1-2 to test before committing to large pack
- **Animations:** Expensive (1 credit) but impactful - use sparingly
- **Post-processing:** Each edit costs 1 credit - plan edits carefully

**Avoiding Waste:**
- Double-check all settings before generating
- Use Preview-focused layout to see results clearly
- Save successful configurations for reuse
- Don't re-calibrate same photo unnecessarily

---

### Workflow Recommendations

#### **Beginner Workflow** (Minimize decisions)
1. Input Mode: From Image
2. Upload clear photo â†’ Wait for auto-calibration
3. Select 4 expressions from "Recommended First Pack" above
4. Leave style at Cartoon Vector
5. Leave palette at Vibrant
6. Pack size: 4
7. Generate!

**Result:** Reliable, high-quality first pack in ~30 seconds.

---

#### **Advanced Workflow** (Maximum control)
1. Upload photo
2. Manually calibrate (verify faceprint)
3. Edit Identity Template if needed
4. Select expressions thoughtfully (themed pack)
5. Experiment with artistic style
6. Adjust palette to match style
7. Set Identity Lock Strength to Maximum
8. Use higher resolution (1024px)
9. Generate and review validation scores
10. Re-generate any low-scoring stickers individually

**Result:** Perfected, consistent pack with validated identity.

---

#### **Professional Workflow** (Best for content creators)
1. Prepare source photo professionally (lighting, composition)
2. Calibrate carefully
3. Create master character in Character Library
4. Design themed expression packs (8-12 stickers each)
5. Maintain style consistency across packs
6. Archive successful generations
7. Document settings for reproduction
8. Export collections for backup

---

### Common Mistakes to Avoid

âŒ **Using low-quality photos**
- Blurry, dark, filtered photos produce inconsistent results
- AI can't preserve identity it can't clearly see

âŒ **Selecting too many random expressions**
- Unfocused packs lack thematic coherence
- Better to create multiple themed packs

âŒ **Ignoring style compatibility**
- The system auto-filters for a reason!
- Don't fight the disabled dropdowns

âŒ **Not checking validation results**
- Always review validation scores in V2 mode
- Low scores mean identity wasn't preserved well

âŒ **Clearing browser data frequently**
- Wipes your image cache
- Lose calibrated identities

âŒ **Skipping calibration verification**
- Auto-calibration is accurate, but manual verification helps you understand the system

---

### Pro Tips

ðŸ’¡ **Use Collection as Your Library**
- Drag previous stickers back to restore identities instantly
- Saves calibration credits
- Build on proven successful generations

ðŸ’¡ **The "Inspire Me" Button is Powerful**
- Stuck creatively? Click it!
- Gets AI-generated style/palette combinations
- Often suggests combinations you wouldn't think of

ðŸ’¡ **Batch Similar Styles**
- Generate all Cartoon Vector stickers in one session
- Then switch to 3D Render for another batch
- More efficient than style-hopping

ðŸ’¡ **Composition Matters for Gestures**
- Any expression with "${COMPOSITION_HANDLE}" in description needs Half-Body or Full-Body
- Check expression descriptions if hands/arms are cut off

ðŸ’¡ **Speech Bubbles Add Personality**
- Even default speech bubbles can be customized
- Change "Morning!" to "Morning, beautiful!" for personal touch
- Use emojis in bubbles for extra expressiveness

ðŸ’¡ **Animation Styles Match Expression Energy**
- Calm expressions (Nod, Thinking): Use Subtle Movement or Floating
- Energetic expressions (Celebrating, High Five): Use Bouncing or Spinning
- Shocking expressions (Mind Blown, Gasp): Use Pulsing or Zoom

ðŸ’¡ **Resolution Doesn't Affect Quality Significantly**
- 512px is perfectly fine for messaging apps
- Save 1024px for printing or archival
- Difference is subtle on small screens

---


## 14. TECHNICAL DEEP DIVE

### Architecture Overview

Sticker Studio is built on a **React `useReducer` architecture** with centralized state management.

#### **Core Technologies:**
- **React 19**: UI framework
- **TypeScript**: Type safety
- **Google Gemini API**: AI processing
- **Veo 2.0**: Video generation
- **IndexedDB**: Persistent storage
- **Vite**: Build tool

---

### State Management

#### **Single Source of Truth**
All application state lives in `AppState` object:
```typescript
interface AppState {
  settings: Settings;           // All sticker configuration
  calibrationStep: CalibrationStep;
  isLoading: boolean;
  credits: number;
  results: GeneratedResult[];
  // ... and more
}
```

#### **Immutable State Updates**
Every change creates a new state object:
```typescript
// CORRECT:
return { ...state, credits: state.credits - cost };

// WRONG (mutation):
state.credits -= cost;
```

#### **Action-Based Updates**
All state changes go through dispatched actions:
```typescript
dispatch({ type: 'SET_SETTING', payload: { style: 'Kawaii' } });
dispatch({ type: 'START_GENERATION', payload: 'Generating...' });
dispatch({ type: 'GENERATION_COMPLETE', payload: results });
```

---

### The Generation Pipeline

#### **Hook Architecture:**

**useGeneration Hook:**
- Main generation orchestrator
- Handles cost calculation
- Manages confirmation flow
- Executes generation logic
- Handles success/failure

**useCalibration Hook:**
- Identity Lock workflow manager
- Handles all calibration steps
- Manages verification process
- Credit deduction/refund for calibration

**useImageUpload Hook:**
- Image upload handling
- Cache management
- Pre-analysis triggering

---

### API Integration

#### **Models Used:**

**Image Generation:**
- Model: `gemini-2.5-flash-image-preview`
- Use: Static sticker generation, image editing
- Input: Image + Text prompt
- Output: Image (base64)

**Video Generation:**
- Model: `veo-2.0-generate-001`
- Use: Animated sticker generation
- Input: Image + Text prompt
- Output: Video file (downloaded from URL)

**Text Analysis:**
- Model: `gemini-2.5-flash`
- Use: Face analysis, pose description, JSON responses
- Input: Image (for analysis) or Text
- Output: JSON or Text

#### **API Safety Layers:**

**1. Circuit Breaker:**
- Prevents cascade failures
- Opens circuit after 5 consecutive failures
- Auto-resets after cooldown period

**2. Rate Limiter:**
- Prevents API quota exhaustion
- Enforces minimum delays between calls
- Token bucket algorithm

**3. Request Deduplication:**
- Prevents duplicate simultaneous requests
- Saves credits and API quota

**4. API Serializer:**
- Queues concurrent requests
- Executes sequentially
- Prevents race conditions

**5. Network Monitoring:**
- Detects offline/online status
- Warns user before API calls
- Prevents failed requests

---

### Credit System

#### **Transaction Logging:**
Every credit change is logged with:
- Amount (positive or negative)
- Reason (e.g., "Sticker generation", "Failed refund")
- Timestamp
- Metadata (pack size, output format, etc.)

#### **Automatic Refunds:**
ALL failures trigger immediate refunds:
```typescript
try {
  // Deduct credits
  dispatch({ type: 'CHANGE_CREDITS_BY', payload: { amount: -cost }});
  // Perform generation
  const result = await generate();
} catch (error) {
  // Auto-refund on failure
  dispatch({ type: 'CHANGE_CREDITS_BY', payload: { amount: cost }});
}
```

**Refund Scenarios:**
- Generation fails (any error)
- User cancels animation
- Validation fails repeatedly
- Network error
- API error

---

### Identity Lock V2 Technical Details

#### **The Identity Anchor Object:**

```typescript
interface IdentityAnchor {
  sourceImageBase64: string;          // Original photo
  biometricProfile: BiometricProfile; // Complete facial analysis
  neutralFaceBase64: string;          // Generated neutral reference
  identityFingerprint: string;        // Compact 150-word description
}
```

#### **Generation with Identity Lock:**

**Prompt Structure:**
```
ðŸ”’ IDENTITY-LOCKED GENERATION

=== PRIORITY ORDER ===
1. FACIAL IDENTITY (must match exactly)
2. Target expression
3. Visual style

=== IDENTITY ANCHOR ===
[Identity fingerprint inserted here]

=== TASK ===
Expression: Laughing
Style: Cartoon Vector

=== MANDATORY CONSTRAINTS ===
Generated image MUST maintain:
- Exact bone structure
- Precise eye characteristics
- Identical nose structure
- Same lip shape
- Skin tone consistency
[+ Distinctive features if present]

=== STYLE RULES ===
- Apply style to CLOTHING/BACKGROUND/EFFECTS only
- Facial features stay photorealistic-accurate
- If style conflicts with identity, IDENTITY WINS
```

#### **Validation Algorithm:**

1. **Compare** generated image to neutral reference
2. **Analyze** face shape, eyes, nose, mouth, features
3. **Score** similarity (0-100)
4. **Scoring Rubric:**
   - 95-100: Perfect match (rare)
   - 85-94: Strong match âœ“ VALID
   - 70-84: Recognizable but notable differences
   - <70: Identity not preserved âœ— FAILED

5. **Decision:**
   - Score >= 85: Accept
   - Score < 85 AND attempts remaining: Retry
   - Score < 85 AND no attempts left: Accept with warning

---

### Performance Optimizations

#### **Image Caching:**
- All images stored in IndexedDB
- Prevents re-downloading
- Faster preview loading
- Survives page refresh

#### **State Persistence:**
- Entire app state saved to IndexedDB
- Auto-saves on every change
- Survives browser crash
- Enables undo/redo system

#### **Component Memoization:**
- StickerStudioWorkflow uses React.memo
- Prevents unnecessary re-renders
- Custom equality check
- Only re-renders when relevant props change

#### **Lazy Loading:**
- Expression icons lazy-loaded
- Animation gallery on-demand
- Modals rendered only when open

---

### Data Flow

#### **Sticker Generation Flow:**

```
User clicks "Generate"
  â†“
Pre-flight checks (credits, identity, expressions)
  â†“
Confirmation dialog shown
  â†“
User confirms
  â†“
Credits deducted immediately
  â†“
For each expression in pack:
  â”œâ†’ Build AI prompt (persona + identity + expression + style)
  â”œâ†’ Call Gemini API
  â”œâ†’ Receive base64 image
  â”œâ†’ (If V2) Validate against neutral reference
  â”œâ†’ (If invalid & attempts left) Retry
  â””â†’ Store result with metadata
  â†“
All results dispatched to state
  â†“
Auto-saved to Collection
  â†“
Loading state cleared
  â†“
Success message shown
```

#### **Error Handling Flow:**

```
Error occurs at any point
  â†“
Catch block triggered
  â†“
Calculate refund amount (original cost)
  â†“
Dispatch CHANGE_CREDITS_BY (positive amount)
  â†“
Dispatch GENERATION_ERROR (user-friendly message)
  â†“
Log failure to activity log
  â†“
Create failure result object
  â†“
Add to Collection (for debugging)
  â†“
User sees error message + refund confirmation
```

---

### File Organization

#### **Key Files for Sticker Studio:**

**UI Components:**
- `compliance/components/StickerStudioWorkflow.tsx` (main UI)
- `compliance/components/StickerPreview.tsx` (result display)
- `compliance/components/AnimationStyleGallery.tsx` (animation browser)

**Business Logic:**
- `hooks/useGeneration.ts` (generation orchestration)
- `hooks/useCalibration.ts` (identity lock logic)
- `utils/services/geminiService.ts` (API calls)
- `utils/services/identityPreservation.ts` (Identity Lock V2)

**State Management:**
- `reducers/generationReducer.ts` (generation state)
- `reducers/calibrationReducer.ts` (calibration state)
- `reducers/settingsReducer.ts` (user settings)

**Constants & Data:**
- `constants/expressions.ts` (all 36+ expressions)
- `constants.ts` (styles, palettes, costs)

---

### Debug Mode

#### **Accessing Debug Information:**

**Browser Console:**
- Shows detailed generation logs
- API call information
- State changes
- Error stack traces

**Activity Log** (in app):
- Click hamburger menu â†’ Dev Log
- Shows all actions with timestamps
- Filter by type (info, error, success, credit)
- Search functionality

**Collection Modal:**
- Click "Copy All Data" button
- Gets complete generation history
- Includes prompts, settings, validation data
- Paste into text editor for analysis

#### **Useful Console Messages:**

```
--- Sticker Gen Start ---
```
Shows: Current settings snapshot

```
--- Sticker Gen Credit Deduction ---
```
Shows: Cost, pack size, isPoseOnly

```
Calibration lock is active. Skipping concurrent autoCalibrate call.
```
Info: Prevents race conditions (not an error)

```
Using cached calibration results. Skipping re-calibration.
```
Info: Optimization (saves credit)

---

### Advanced Customization

#### **Identity Template Manual Editing:**

**Structure:**
```json
{
  "bone_structure": { ... },
  "eye_biometrics": { ... },
  "nose_structure": { ... },
  "mouth_features": { ... },
  "distinctive_features": { ... },
  "skin_tone": { ... }
}
```

**Safe to Edit:**
- Hair style/color if AI got it wrong
- Add missing moles/freckles
- Correct jewelry descriptions
- Adjust skin tone description

**Don't Edit (Can Break Generation):**
- Bone structure (core identity)
- Eye/nose/mouth structure unless clearly wrong
- Top-level property names
- Data types (don't change numbers to strings)

---

### Browser Compatibility

**Recommended:**
- Chrome/Edge 90+ âœ…
- Firefox 88+ âœ…
- Safari 14+ âœ…

**Required Features:**
- IndexedDB support
- Fetch API
- FileReader API
- Drag and drop API
- Canvas API (for image processing)

**Mobile:**
- iOS Safari: Works but slower
- Chrome Android: Full support
- Touch gestures supported

---

### Privacy & Data Storage

**What's Stored Locally:**
- Your uploaded photos (IndexedDB)
- Generated stickers (IndexedDB)
- Identity templates (IndexedDB)
- App settings (IndexedDB)
- Credit history (IndexedDB)

**What's Sent to Google:**
- Uploaded photos (for analysis)
- Generation prompts
- Identity templates (in prompts)

**What's NOT Stored:**
- Sent images are not permanently stored by Google (per API terms)
- No server-side storage in this app
- Everything is client-side

**Data Persistence:**
- Data survives browser restart
- Data cleared if you clear browser data
- No cloud backup (local only)
- Export collections for manual backup

---

## CONCLUSION

Congratulations! You now have complete mastery of the Sticker Studio. This guide covered:

âœ… Both input modes (Image and Text)
âœ… Complete Identity Lock system (V1 and V2)
âœ… All 36+ expressions in detail
âœ… All 15 artistic styles
âœ… Static and animated output formats
âœ… Advanced animation controls
âœ… Pack and quality optimization
âœ… Complete generation pipeline
âœ… Troubleshooting and FAQs
âœ… Professional tips and strategies
âœ… Technical architecture

**Next Steps:**
1. Create your first sticker pack using the Quick Start guide
2. Experiment with different styles
3. Build your themed packs
4. Share your creations!

**Remember:**
- Start simple, experiment later
- Quality photo = quality results
- Identity Lock is your friend
- Have fun and be creative!

---

## APPENDIX: QUICK REFERENCE

### Credit Costs Summary
- Calibration: 1 credit (one-time)
- Static sticker: 1 credit per sticker
- Animated sticker: 1 credit (fixed)
- Post-processing edit: 1 credit per edit

### Default Settings (Recommended for Beginners)
- Input Mode: From Image
- Style: Cartoon Vector
- Palette: Vibrant
- Line Style: Smooth
- Shading: Cel-shading
- Composition: Half-Body
- Output: Static
- Pack Size: 4
- Resolution: 768px

### Expression Quick Picks

**Must-Have 4:**
1. HEY
2. Thumbs Up
3. Laughing
4. Thinking

**Popular 8:**
1. HEY
2. Thumbs Up
3. Laughing
4. Love You
5. Facepalm
6. Wink
7. Peace Sign
8. Celebrating

**Comprehensive 12:**
1. HEY
2. Thumbs Up
3. Laughing
4. Sad
5. Love You
6. Facepalm
7. Wink
8. Thinking
9. Peace Sign
10. Celebrating
11. Coffee
12. Deal With It

### Keyboard Shortcuts
- **Ctrl+Z**: Undo
- **Ctrl+Shift+Z**: Redo
- **Ctrl+V**: Paste image to upload
- **Escape**: Close modals

---

## 🔍 BEHIND THE SCENES: AI PROMPTS USED

This section reveals the actual prompts that AI Sticker Studio sends to the AI models. Understanding these prompts gives you insight into how Identity Lock and sticker generation work under the hood.

### The Four Pillars Prompt Engineering Framework

**Before diving into specific prompts**, understand the methodology behind them. Every prompt in AI Sticker Studio follows the "Four Pillars" framework from the official Prompt Engineering Playbook:

#### **Pillar 1: The Expert Persona (Role & Authority) 🎭**

The AI is assigned a detailed, expert role:
- **Role**: Specific job title (e.g., "Forensic Facial Analyst", "Master Motion Graphics Artist")
- **Specialization**: Area of expertise (e.g., "biometric profile creation", "looping animations")
- **Accolades**: What it's known for (e.g., "work featured in blockbuster films")
- **Key Skills**: Specific techniques (e.g., "seamless loop composition", "identity preservation")

**Why This Works**: The AI performs better when given a specific role and expertise context.

#### **Pillar 2: Rich Context (The Mission) 🗺️**

The AI needs to understand the "why":
- **Background**: User's goal explained
- **Source Data**: All input data clearly labeled
- **Definitions**: Project-specific terms defined (e.g., "Identity Lock")

**Why This Works**: Context prevents ambiguity and helps the AI make informed decisions.

#### **Pillar 3: Unambiguous Constraints (The Guardrails) 🚦**

Non-negotiable rules for safety, consistency, correctness:
- **Primary Directive**: Single most important goal that cannot be compromised
- **Positive Constraints**: What the output MUST include
- **Negative Constraints**: What the AI MUST NOT do

**Why This Works**: Explicit constraints prevent common AI failures and ensure quality.

#### **Pillar 4: Precise Output Formatting (The Blueprint) 📐**

Never assume the AI will guess the format:
- **Structure**: Exact format specified (JSON, image, video, etc.)
- **Schema**: For JSON, provide clear schema or example
- **Technical Specs**: Resolution, transparency, file type, etc.

**Why This Works**: Eliminates ambiguity about the deliverable.

---

### File Structure: Where Prompts Are Defined

**Location in Codebase**:

```
AI STICKER STUDIO - CORE MODEL/
├── utils/
│   └── services/
│       ├── geminiService.ts           ← Main generation prompts
│       │   ├── generateStaticStickers()  (Sticker V1 prompts)
│       │   ├── generateAnimatedSticker() (Animation prompts)
│       │   ├── generateBackground()      (Photo Remix backgrounds)
│       │   ├── remixForeground()         (Photo Remix foreground)
│       │   └── compositeImages()         (Photo Remix compositing)
│       │
│       └── identityPreservation.ts    ← Identity Lock V2 prompts
│           ├── generateNeutralReference()
│           ├── extractBiometricProfile()
│           ├── createIdentityFingerprint()
│           ├── generateWithIdentityLock() (Sticker V2 prompts)
│           └── validateIdentity()
│
├── hooks/
│   ├── useGeneration.ts               ← Orchestrates sticker generation
│   ├── useRemix.ts                    ← Orchestrates Photo Remix
│   └── useCalibration.ts              ← Orchestrates calibration
│
├── Prompt Engineering Playbook - Sticker & Animated Sticker.md
├── Prompt Engineering Playbook - Photo Remix.md
└── Prompt Engineering Playbook - Wallpaper.md
```

**Key Files**:
- **`geminiService.ts`** (lines 55-221): All main generation functions
- **`identityPreservation.ts`** (lines 36-301): Identity Lock V2 system
- **Playbooks**: High-level prompt design guidelines

---

### How Artistic Styles Change the Prompt & Persona

**THIS IS CRITICAL**: The expert persona and constraints ADAPT based on the artistic style selected!

#### **Base Expert Persona** (All Styles):
```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers.
```

**But this changes based on style...**

---

#### **Style 1: Cartoon Vector / Sticker Style**

**Expert Persona**:
```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers.
Your expertise includes smooth gradients, bold outlines, and cel-shaded depth.
```

**Prompt Addition**:
```
**Artistic Style:**
- Overall Style: Cartoon Vector
- Color Palette: Vibrant (bold, saturated, punchy colors)
- Line Style: Smooth (perfect, computer-precise lines)
- Shading Style: Cel-shading (anime-style with 2-3 distinct color zones)

**Style-Specific Requirements:**
- Use clean vector shapes with smooth bezier curves
- Apply cel-shading with hard edge transitions
- Bold outlines should be consistent thickness throughout
- Colors should be vibrant and high-contrast for visibility
```

**Temperature**: 0.7 (balanced)

---

#### **Style 2: Kawaii**

**Expert Persona CHANGES**:
```
You are a master of Japanese kawaii character design, specializing in creating adorable,
expressive characters with oversized features and soft, approachable aesthetics.
Your signature is making characters irresistibly cute while maintaining personality.
```

**Prompt Addition**:
```
**Kawaii Style Requirements:**
- Eyes: SIGNIFICANTLY larger than realistic proportions (占face 30-40%)
- Nose: Minimized or simplified to tiny dot/line
- Mouth: Small, simple, expressive
- Cheeks: Add soft blush marks
- Head: Slightly enlarged relative to body (1:6 or 1:5 ratio)
- Expression: Amplify cuteness factor
- Colors: Lean toward pastel if palette allows
- Overall: "Cute" should be the dominant aesthetic

**CRITICAL**: While making the character kawaii-style, you MUST still preserve
their core identity features (eye color, face shape, hair, distinctive marks).
```

**Temperature**: 0.8 (more creative for cute variations)

**Constraint Modification**: Identity preservation is relaxed slightly for artistic transformation, but core features remain.

---

#### **Style 3: Chibi**

**Expert Persona CHANGES**:
```
You are a master of chibi/super-deformed character art, known for creating adorable
miniature versions of characters with exaggerated proportions. Your specialty is the
classic 1:2 or 1:3 head-to-body ratio that defines the chibi aesthetic.
```

**Prompt Addition**:
```
**Chibi Style Requirements:**
- Head-to-Body Ratio: 1:2 or 1:3 (head is MASSIVE relative to body)
- Limbs: Short, stubby, simplified
- Hands/Feet: Simplified to mitt-like shapes
- Features: Large eyes, small nose/mouth (similar to kawaii)
- Pose: Adapt expression to chibi proportions
- Cuteness: Maximum adorable factor

**Composition Requirement**: If Half-Body or Full-Body is selected, the chibi
proportions MUST be clearly visible. Headshot defeats the purpose of chibi style.

**Identity Preservation**: Maintain hair style, eye color, distinctive features,
but adapted to chibi's exaggerated proportions.
```

**Temperature**: 0.8 (creative for proportion adaptation)

---

#### **Style 4: Photorealistic**

**Expert Persona CHANGES**:
```
You are a master CGI artist specializing in hyper-realistic human renders,
with expertise in subsurface scattering, realistic skin textures, and
photographic lighting. Your work is indistinguishable from high-end photography.
```

**Prompt Addition**:
```
**Photorealistic Requirements:**
- Skin: Realistic texture with pores, subtle imperfections, subsurface scattering
- Lighting: Photographic quality with realistic light falloff
- Shading: Gradient (ONLY option - realistic depth is required)
- Lines: None (photos don't have outlines)
- Hair: Individual strands with realistic shine and texture
- Eyes: Realistic iris detail, catch lights, proper depth
- Clothing: Realistic fabric textures and wrinkles

**Identity Preservation**: MAXIMUM strictness. Every facial feature must be
photorealistically accurate to the Identity Lock data.
```

**Temperature**: 0.5 (more deterministic for realism)

**Constraint Amplification**: Identity constraints are STRICTEST for this style.

---

#### **Style 5: 3D Render**

**Expert Persona CHANGES**:
```
You are a master 3D character artist specializing in modern CGI rendering,
with expertise in physically-based rendering (PBR), realistic lighting,
and professional 3D character modeling. Your work appears in animated films.
```

**Prompt Addition**:
```
**3D Render Requirements:**
- Geometry: Clean, professional 3D modeling topology
- Lighting: Realistic 3-point lighting with proper shadows
- Materials: PBR materials with proper specularity and roughness
- Shading: Gradient (realistic depth from 3D lighting)
- Lines: None (3D objects don't have outlines)
- Depth: Strong sense of dimensionality
- Quality: Film-quality CGI rendering

**Style Balance**: Character should feel like a 3D model but still maintain
recognizable features from Identity Lock.
```

**Temperature**: 0.6 (balanced for technical + artistic)

---

#### **Style 6: WPAP (Wedha's Pop Art Portrait)**

**Expert Persona CHANGES**:
```
You are a master of WPAP (Wedha's Pop Art Portrait) style, specializing in
geometric faceted portraits with bold, angular shapes and vibrant color blocking.
You're skilled at deconstructing faces into geometric planes while maintaining
recognizability.
```

**Prompt Addition**:
```
**WPAP Requirements:**
- Geometry: Face deconstructed into angular, faceted shapes
- Lines: Bold (thick, geometric borders between color blocks)
- Shading: Flat (NO gradients - solid color blocks only)
- Colors: High contrast, vibrant color blocking
- Angles: Sharp, geometric, no curves
- Complexity: Multiple color zones creating depth through color variation

**Identity Challenge**: This is one of the HARDEST styles for identity preservation.
The geometric deconstruction must still maintain recognizable features:
- Face shape overall
- Eye placement and general shape
- Hair silhouette
- Distinctive markers (if possible to represent geometrically)

**Difficulty Warning**: WPAP may require multiple retries in V2 validation.
```

**Temperature**: 0.9 (highly creative for geometric interpretation)

**Constraint Relaxation**: Identity validation scoring is more lenient (70+ instead of 85+).

---

#### **Style 7: Lineart**

**Expert Persona CHANGES**:
```
You are a master line artist specializing in clean, expressive line drawings.
Your expertise is creating elegant illustrations with line weight variation
and minimal or no fill colors. Your work has a timeless, sketch-like quality.
```

**Prompt Addition**:
```
**Lineart Requirements:**
- Primary Element: Clean, confident linework
- Lines: Can be Thin, Bold, Hand-drawn, or Smooth
- Shading: None (lineart doesn't use shading - depth comes from line weight)
- Fill: Minimal or none (focus is on the lines)
- Style: Clean, professional line quality
- Expression: Conveyed through line work and gesture

**Technical**: Output should feel like a professional sketch or line drawing.
```

**Temperature**: 0.7

---

#### **Style 8: Watercolor**

**Expert Persona CHANGES**:
```
You are a master watercolor artist specializing in digital watercolor techniques.
Your signature is soft, flowing edges, color bleeding, and the organic,
spontaneous quality of traditional watercolor painting.
```

**Prompt Addition**:
```
**Watercolor Requirements:**
- Edges: Soft, flowing, with intentional color bleeding
- Colors: Translucent, layered washes
- Lines: Thin, Hand-drawn, or None (soft sketch lines if present)
- Shading: Gradient or None (organic color variation)
- Texture: Visible watercolor paper texture
- Spontaneity: Organic, natural, not overly precise

**Artistic Freedom**: Watercolor allows for more artistic interpretation while
maintaining identity. Some softness to features is acceptable.
```

**Temperature**: 0.8 (creative for watercolor effects)

---

#### **Style 9: Oil Painting**

**Expert Persona CHANGES**:
```
You are a master oil painter in the tradition of classical portraiture,
with expertise in visible brush strokes, rich color layering, and the
textural quality of oil on canvas. Your work evokes old masters.
```

**Prompt Addition**:
```
**Oil Painting Requirements:**
- Brush Strokes: Visible, textured, with directionality
- Colors: Rich, deep, layered
- Lines: None, Smooth, Hand-drawn, or Bold (painterly strokes)
- Shading: Gradient (realistic depth from lighting)
- Texture: Canvas texture visible
- Quality: Fine art, museum-quality aesthetic

**Identity in Art**: Features should be recognizable but rendered in
classical oil painting style with artistic interpretation.
```

**Temperature**: 0.7

---

#### **Style 10: Pencil Sketch**

**Expert Persona CHANGES**:
```
You are a master sketch artist specializing in expressive pencil drawings.
Your expertise is creating gestural, organic sketches with varied pencil
pressure, cross-hatching, and the raw, artistic quality of hand-drawn work.
```

**Prompt Addition**:
```
**Pencil Sketch Requirements:**
- Medium: Pencil/graphite aesthetic
- Lines: Hand-drawn or Thin (sketchy, organic quality)
- Shading: None (depth created through cross-hatching and pencil pressure)
- Texture: Paper grain visible
- Quality: Artistic sketch, not overly refined
- Style: Gestural, with visible construction lines acceptable

**Artistic Nature**: Sketch style allows for more organic interpretation.
```

**Temperature**: 0.8

---

### How Style Affects Identity Lock Validation

**Identity Validation Scoring** (Identity Lock V2):

| Style | Validation Threshold | Reasoning |
|-------|---------------------|-----------|
| **Photorealistic** | 90+ | Must be nearly perfect |
| **3D Render** | 85+ | Standard threshold |
| **Cartoon Vector** | 85+ | Standard threshold |
| **Kawaii** | 80+ | Stylization acceptable |
| **Chibi** | 80+ | Proportion changes expected |
| **Oil Painting** | 80+ | Artistic interpretation |
| **Watercolor** | 75+ | Soft edges acceptable |
| **WPAP** | 70+ | Geometric deconstruction difficult |
| **Lineart** | 75+ | Minimal detail is normal |
| **Pencil Sketch** | 75+ | Sketch quality expected |

**Validation Prompt Adapts**:

For WPAP:
```
SCORING (ADJUSTED FOR WPAP):
85-100: Strong geometric interpretation maintaining features
70-84: Recognizable despite geometric deconstruction
<70: Too abstract, identity lost
```

For Photorealistic:
```
SCORING (STRICT FOR PHOTOREALISM):
95-100: Perfect photographic match
90-94: Minor artistic liberties
85-89: Noticeable but acceptable differences
<85: Identity not preserved adequately
```

---

### 1. Identity Lock V2 Prompts

#### 1.1 Neutral Reference Generation Prompt

**Purpose**: Creates a forensic-quality neutral face for identity matching  
**Model**: `gemini-2.5-flash-image-preview`

```
CRITICAL: Create neutral identity reference.

Generate perfectly forward-facing portrait with:
- Neutral expression (no smile, no emotion)
- Even studio lighting
- Clear focus on facial features
- Remove accessories (glasses, hats, jewelry)
- Plain background

PRESERVE EXACTLY:
- Bone structure, face shape
- Eye color, shape, spacing
- Nose structure
- Lip shape and fullness
- Skin tone
- Hair style and color
- Permanent features (moles, dimples, scars)

IGNORE: Current expression, lighting, camera angle, temporary elements

This is forensic identity capture for biometric matching.
```

#### 1.2 Biometric Profile Extraction Prompt

**Purpose**: Analyzes both source and neutral images to extract permanent facial features  
**Model**: `gemini-2.5-flash`  
**Output**: JSON format

```
Forensic facial analysis. Analyze BOTH images (original + neutral reference).

Extract PERMANENT FEATURES ONLY. Output exact JSON:
{
  "bone_structure": {
    "face_shape": "oval/round/square/heart/diamond/oblong/triangular",
    "jawline": "prominence + angle description",
    "cheekbones": "height + prominence description",
    "chin": "shape + projection description",
    "forehead": "height + width description"
  },
  "eye_biometrics": {
    "iris_color": "precise color (not just 'brown')",
    "eye_shape": "almond/round/hooded/upturned/downturned",
    "pupillary_distance": "wide-set/average/close-set",
    "eyelid_type": "monolid/single/double/hooded",
    "eyebrow_shape": "shape, thickness"
  },
  "nose_structure": {
    "bridge_width": "narrow/medium/wide",
    "bridge_height": "flat/low/medium/high",
    "nostril_shape": "round/oval/narrow, flared/neutral",
    "tip_shape": "bulbous/pointed/rounded/upturned",
    "overall_size": "small/medium/large"
  },
  "mouth_features": {
    "lip_fullness": {
      "upper": "thin/medium/full",
      "lower": "thin/medium/full"
    },
    "cupids_bow": "undefined/subtle/moderate/pronounced",
    "mouth_width": "narrow/medium/wide"
  },
  "distinctive_features": {
    "dimples": "none/location description",
    "hair_style": "EXACT style, length, cut, texture, color",
    "earrings": "none/type, which ear, size",
    "tattoos": "none/exact location and design",
    "piercings": "none/exact location",
    "markers": "moles/freckles/scars with locations"
  },
  "skin_tone": {
    "base": "fair/medium/tan/deep with description",
    "undertones": "cool/warm/neutral"
  }
}
```

#### 1.3 Identity Fingerprint Creation Prompt

**Purpose**: Converts the detailed biometric profile into a compact 150-word identity fingerprint  
**Model**: `gemini-2.5-flash`

```
Convert this biometric profile into compact identity fingerprint (max 150 words):

[BIOMETRIC PROFILE JSON INSERTED HERE]

Create fingerprint that:
1. Prioritizes MOST distinctive features
2. Uses precise, measurable language
3. Emphasizes features surviving style transformation
4. Mentions hair, dimples, tattoos, earrings if present

Single paragraph format.
```

#### 1.4 Identity-Locked Generation Prompt

**Purpose**: Generates a sticker while preserving exact facial identity  
**Model**: `gemini-2.5-flash-image-preview` or `gemini-2.5-flash-video-preview` (animated)  
**Inputs**: Neutral face image + Source image + Identity fingerprint

```
🔒 IDENTITY-LOCKED GENERATION

=== PRIORITY ORDER ===
1. FACIAL IDENTITY (must match exactly)
2. Target expression
3. Visual style

=== IDENTITY ANCHOR ===
Reference Face (neutral, forward-facing):
[NEUTRAL FACE IMAGE]

Source Image (for additional context):
[SOURCE IMAGE]

IDENTITY FINGERPRINT:
[COMPACT BIOMETRIC FINGERPRINT TEXT]

=== ABSOLUTE CONSTRAINTS (VIOLATION = FAILURE) ===
❌ Face shape, bone structure CANNOT change
❌ Eye color, shape, spacing CANNOT change
❌ Nose structure CANNOT change
❌ Lip shape, fullness CANNOT change
❌ Skin tone CANNOT change
❌ Hair style/color CANNOT change unless specifically requested
❌ Distinctive features (dimples, earrings, tattoos) CANNOT be removed

=== TARGET EXPRESSION ===
[EXPRESSION NAME, e.g., "Thumbs Up"]

Capture this pose/emotion while maintaining exact identity match to reference images.

=== VISUAL STYLE ===
[STYLE NAME, e.g., "Cartoon Vector"]
[ADDITIONAL STYLE SETTINGS like palette, line style, shading]

Apply this artistic transformation while preserving the identity features above.

=== COMPOSITION ===
- Format: [Half-Body/Full-Body/Portrait-Only]
- Background: [Transparent/Dynamic/Solid Color]
- [Additional composition details]

=== OUTPUT REQUIREMENTS ===
- Single [image/video] file
- [If animated: Loop duration, animation style]
- Clear, high-quality output
- CRITICAL: Identity match must be verifiable by comparing to neutral reference

[ADDITIONAL PROMPT if provided by user]
```

#### 1.5 Identity Validation Prompt

**Purpose**: Scores the generated sticker against the original identity to detect failures  
**Model**: `gemini-2.5-flash`  
**Inputs**: Neutral face + Generated sticker  
**Output**: JSON with validation score

```
IDENTITY VALIDATION TASK

Compare these two images:
1. REFERENCE: [Neutral face image]
2. GENERATED: [New sticker image]

Score identity preservation (0-100):
- 100 = Perfect match (same person, obvious)
- 80-99 = Strong match (same person, minor artistic liberties)
- 60-79 = Acceptable (recognizably same person, noticeable differences)
- 40-59 = Weak (questionable if same person)
- 0-39 = Failed (clearly different person)

Focus on IMMUTABLE features:
- Face shape, bone structure
- Eye color, shape, spacing
- Nose structure
- Lip fullness, shape
- Distinctive markers (moles, dimples, tattoos, earrings)

Ignore EXPECTED differences:
- Expression changes
- Artistic style transformation
- Pose/angle
- Clothing/accessories

Output exact JSON:
{
  "identity_score": [0-100 number],
  "rationale": "[Brief explanation of score]",
  "passed": [true if score >= 70, false otherwise]
}
```

---

### 2. Supporting Prompts

#### 2.1 Pose Calibration Prompt

**Purpose**: Analyzes "Pose from image" to describe the custom pose  
**Model**: `gemini-2.5-flash`

```
Analyze the provided image and give a concise, one-sentence description of the 
person's pose and expression. For example: "A person smiling and giving a thumbs up."
```

#### 2.2 Character Analysis Prompt

**Purpose**: Auto-fills character metadata when creating a new character  
**Model**: `gemini-2.5-flash`  
**Output**: JSON

```
Analyze the person in this photo and return a JSON object with the following properties:
- 'gender': "Male", "Female", or "Non-binary".
- 'ageGroup': "Child", "Teenager", "Young Adult", "Adult", "Senior".
- 'ethnicity': A best guess at the person's ethnicity.
- 'identityTemplate': A detailed JSON string of their facial analysis (bone structure, eyes, hair, etc.).
- 'mood': The dominant mood or emotion conveyed (e.g., 'Joyful', 'Serious', 'Thoughtful').
- 'style': The overall style of the photo (e.g., 'Candid Portrait', 'Professional Headshot', 'Action Shot').

Output ONLY the raw JSON object.
```

#### 2.3 Speech Bubble Placement Prompt

**Purpose**: Adds a speech bubble with custom text to a sticker  
**Model**: `gemini-2.5-flash-image-preview`

```
Place a speech bubble on this image with the text "[USER TEXT]".
- Bubble Style: [standard/cloud/spiky/retro]
- Placement: The bubble should approximately fill the bounding box defined by 
  [y_min:X, x_min:Y, y_max:Z, x_max:W].
- Pointer: The bubble's tail should point towards the most likely speaker in or near the box.
- Readability: Ensure the text is clear and legible.
- Integration: The bubble should match the artistic style of the image.

Return only the modified image.
```

---

### 3. How These Prompts Work Together

**Step-by-Step Identity Lock Flow:**

1. **Upload Photo** → `analyzeFaceStructure` extracts basic biometric JSON
2. **Auto-Calibrate** → `generateNeutralReference` creates forensic face
3. **Deep Analysis** → `extractBiometricProfile` analyzes both images deeply
4. **Fingerprint** → `createIdentityFingerprint` compresses into 150-word description
5. **Generation** → `generateWithIdentityLock` uses neutral face + fingerprint to generate sticker
6. **Validation** → `validateIdentityMatch` scores the result (0-100)
7. **Auto-Retry** → If score < 70, regenerate up to 3 times with stronger constraints

**The "Four Pillars" Prompt Engineering:**

Every generation prompt follows this structure:
1. **Expert Persona** → "You are a professional character artist..."
2. **Rich Context** → Neutral face image + source image + biometric fingerprint
3. **Unambiguous Constraints** → Explicit list of what CANNOT change
4. **Precise Output Formatting** → Exact technical specs for the output

This is why Identity Lock V2 achieves ~95% consistency compared to ~60% with simple text prompts!

---

### 4. Model Selection Strategy

| Task | Model | Why This Model? |
|------|-------|----------------|
| **Neutral Reference** | gemini-2.5-flash-image-preview | Needs image editing (remove expression) |
| **Biometric Extraction** | gemini-2.5-flash | JSON analysis, no image output |
| **Identity Fingerprint** | gemini-2.5-flash | Text compression, no images |
| **Static Sticker** | gemini-2.5-flash-image-preview | Image generation with multi-image context |
| **Animated Sticker** | gemini-2.5-flash-video-preview | Video generation with multi-image context |
| **Identity Validation** | gemini-2.5-flash | JSON scoring, fast inference |
| **Pose Calibration** | gemini-2.5-flash | Simple text description |
| **Speech Bubble** | gemini-2.5-flash-image-preview | Image editing task |

**Temperature Settings:**
- **Neutral Reference**: 0.1 (deterministic, forensic quality)
- **Biometric Extraction**: 0.1 (factual analysis)
- **Identity Fingerprint**: 0.2 (slight creativity in phrasing)
- **Sticker Generation**: 0.7-1.0 (creative, varied outputs)
- **Validation**: 0.1 (objective scoring)

---

### 5. What This Means For You

**Understanding these prompts helps you:**

1. **Trust the System** → You now see the sophisticated engineering behind Identity Lock
2. **Better Photo Selection** → You know the AI analyzes bone structure, eye color, nose shape, etc. → Choose photos where these are clearly visible
3. **Realistic Expectations** → The neutral reference prioritizes permanent features → Temporary makeup or lighting won't be preserved
4. **Troubleshooting** → If identity fails, you know the AI is comparing to a neutral reference → Upload a clearer, more neutral photo
5. **Prompt Optimization** → In Text-to-Image mode, you can now write prompts that align with the AI's biometric analysis structure

**Pro Tip:** The system is looking for **permanent, structural features**. Photos with:
- ✅ Clear, even lighting
- ✅ Forward-facing pose
- ✅ Neutral or mild expression
- ✅ High resolution
- ✅ Unobstructed face

...will generate the best Identity Lock anchors and thus the highest-quality, most consistent stickers!

---

## 6. ACTUAL GENERATION PROMPTS WITH EXAMPLES

Now that you understand the calibration system, let's see the **actual prompts** used during sticker generation with real settings filled in!

### 6.1 Static Sticker Generation (Image-to-Image Mode)

**Purpose**: Generates a static sticker with Identity Lock  
**Model**: `gemini-2.5-flash-image-preview`  
**Inputs**: Identity anchor image + Expression + Style settings

#### **Real Example: Laughing Sticker in Cartoon Vector Style**

**Settings Used**:
- Expression: Laughing
- Style: Cartoon Vector
- Palette: Vibrant
- Line Style: Smooth
- Shading: Cel-shading
- Composition: Half-Body
- Identity Lock Strength: Standard (V2 enabled)

**Actual Prompt Sent to AI**:

```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers. 
Your primary duty is to maintain perfect consistency with the provided Identity Lock profile.

**Primary Directive:** The generated sticker MUST be a perfect likeness of the person in the 
provided photograph. All facial features, hair, and defining characteristics MUST be preserved exactly.

**Identity Anchor:**
- **The character is the person** in the provided photograph.
- **Detailed Analysis:** {"bone_structure":{"face_shape":"oval","jawline":"soft, slightly rounded 
  angle","cheekbones":"moderate height with gentle prominence","chin":"rounded with slight projection",
  "forehead":"average height, slightly wider than jawline"},"eye_biometrics":{"iris_color":"warm 
  dark brown with subtle amber undertones","eye_shape":"almond","pupillary_distance":"average",
  "eyelid_type":"double","eyebrow_shape":"gently arched, medium thickness"},"nose_structure":
  {"bridge_width":"medium","bridge_height":"medium","nostril_shape":"oval, neutral","tip_shape":
  "rounded","overall_size":"medium"},"mouth_features":{"lip_fullness":{"upper":"medium","lower":
  "medium"},"cupids_bow":"moderate","mouth_width":"medium"},"distinctive_features":{"dimples":
  "present when smiling, both cheeks","hair_style":"shoulder-length wavy dark brown hair with 
  side part","earrings":"small silver studs in both ears","tattoos":"none","piercings":"ears only",
  "markers":"small beauty mark above left lip"},"skin_tone":{"base":"medium with warm undertones",
  "undertones":"warm"}}

**Sticker Task:**
1. **Expression/Pose:** Create a sticker of the character with the following expression: 
   "The character is laughing hysterically, head thrown back slightly, eyes squeezed shut with 
   joy, mouth wide open in genuine laughter. Both hands might be clutching their stomach or 
   one hand near their face. Cartoon tears of joy at the corners of their eyes (small droplets). 
   Pure, contagious joy radiates from this pose."

2. **Artistic Style:**
   - **Overall Style:** Cartoon Vector
   - **Color Palette:** Vibrant
   - **Line Style:** Smooth
   - **Shading Style:** Cel-shading

3. **Composition:** Half-Body

4. **Output Format:** The final image MUST have a transparent background (alpha channel). 
   It should be a professional, high-quality sticker.

5. **Negative Prompts:** Avoid the following: blurry, low-quality, text, watermarks
```

**What the AI Receives**:
- **Image 1**: Your original uploaded photo (base64)
- **Image 2** (if V2 enabled): The neutral reference face
- **Text Prompt**: The complete prompt above

**Temperature**: 0.7 (balanced creativity)

---

#### **Real Example 2: Thumbs Up with Speech Bubble**

**Settings Used**:
- Expression: Thumbs Up
- Speech Bubble: "Great job!"
- Style: Sticker Style
- Palette: Vibrant
- Line Style: Bold
- Shading: Gradient
- Composition: Half-Body

**Actual Prompt Sent**:

```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers. 
Your primary duty is to maintain perfect consistency with the provided Identity Lock profile.

**Primary Directive:** The generated sticker MUST be a perfect likeness of the person in the 
provided photograph. All facial features, hair, and defining characteristics MUST be preserved exactly.

**Identity Anchor:**
- **The character is the person** in the provided photograph.
- **Detailed Analysis:** [Same identity template as above]

**Sticker Task:**
1. **Expression/Pose:** Create a sticker of the character with the following expression: 
   "The character is giving an enthusiastic thumbs up with their right hand raised prominently 
   in frame. Big, confident smile. Their body is slightly turned, arm extended forward proudly. 
   This is an unmistakable sign of approval, agreement, or encouragement. The character should 
   have a speech bubble saying "Great job!"."

2. **Artistic Style:**
   - **Overall Style:** Sticker Style
   - **Color Palette:** Vibrant
   - **Line Style:** Bold
   - **Shading Style:** Gradient

3. **Composition:** Half-Body

4. **Output Format:** The final image MUST have a transparent background (alpha channel). 
   It should be a professional, high-quality sticker.

5. **Negative Prompts:** Avoid the following: blurry, low-quality, text, watermarks
```

**Note**: The speech bubble text is injected directly into the expression description!

---

### 6.2 Identity Lock V2 Generation (Advanced Mode)

**Purpose**: Generates sticker with validation and auto-retry  
**Model**: `gemini-2.5-flash-image-preview`  
**Inputs**: Neutral face + Source image + Identity fingerprint

When Identity Lock Strength is set to "Standard" or "Maximum", a more advanced prompt is used:

#### **Real Example: HEY Expression with V2 System**

**Actual Prompt Sent**:

```
🔒 IDENTITY-LOCKED GENERATION

=== PRIORITY ORDER ===
1. FACIAL IDENTITY (must match exactly)
2. Target expression
3. Visual style

=== IDENTITY ANCHOR ===
This person has an oval face shape with a soft, slightly rounded jawline and moderate cheekbone 
prominence. Their warm dark brown eyes are almond-shaped with double eyelids, set at average 
distance apart, beneath gently arched eyebrows of medium thickness. The nose is medium-sized 
with a medium-height bridge and rounded tip. Lips are medium fullness with a moderate cupid's bow. 
Distinctive features include dimples when smiling on both cheeks, shoulder-length wavy dark brown 
hair with a side part, small silver stud earrings in both ears, and a small beauty mark above the 
left lip. Skin tone is medium with warm undertones.

=== TASK ===
Expression: The character is waving enthusiastically with one hand raised high, fingers spread 
in a friendly greeting. Big, genuine smile. The other hand might be on their hip or at their 
side. Body language is open and welcoming. This is the universal "HEY!" greeting - warm, 
inviting, and full of positive energy.

Style: Cartoon Vector, Vibrant colors, Smooth lines, Cel-shading, Half-Body composition

=== MANDATORY CONSTRAINTS ===
Generated image MUST maintain:
- Exact bone structure
- Precise eye characteristics
- Identical nose structure
- Same lip shape
- Skin tone consistency
- CRITICAL: Dimples when appropriate
- CRITICAL: Exact hair style
- CRITICAL: Earrings visible
- CRITICAL: Beauty mark above left lip

=== STYLE RULES ===
- Apply style to CLOTHING/BACKGROUND/EFFECTS only
- Facial features stay photorealistic-accurate
- If style conflicts with identity, IDENTITY WINS

OUTPUT: Transparent background, professional quality
```

**What Happens Next**:

1. **Generation**: AI creates the sticker
2. **Validation**: System compares to neutral reference
3. **Scoring**: Calculates similarity (0-100)
4. **Decision**:
   - Score ≥ 85: ✅ Accept
   - Score < 85 + attempts left: 🔄 Retry with stronger constraints
   - Score < 85 + no attempts: ⚠️ Accept with warning

**Temperature**: 0.3 (more deterministic for identity preservation)

---

### 6.3 Animated Sticker Generation

**Purpose**: Creates looping video sticker  
**Model**: `veo-2.0-generate-001`  
**Inputs**: Identity anchor image + Animation settings

#### **Real Example: Celebrating with Bouncing Animation**

**Settings Used**:
- Expression: Celebrating
- Animation Style: Bouncing
- Speed: 1x
- Loop: Infinite
- Easing: Ease-out
- Style: Kawaii
- Palette: Pastel

**Actual Prompt Sent**:

```
You are a master motion graphics artist and animator specializing in short-form looping 
animations for digital stickers and GIFs. Your work has been featured in top messaging apps 
and you're known for creating mesmerizing, seamless loops that capture personality and 
emotion in 2-3 seconds.

Your expertise includes:
- Character animation and micro-expressions
- Seamless loop composition and timing
- Visual effects that enhance without overwhelming

Create a premium animated sticker with these specifications:

- **Subject Identity:** The character is the person in the provided image. Their identity, 
  facial features, and hair MUST be preserved perfectly.
  
- **Identity Analysis:** {"bone_structure":{"face_shape":"oval",...},"eye_biometrics":{...}}
  [Full identity template inserted here]

- **Expression/Pose:** The character is celebrating triumphantly! Both arms are raised high 
  above their head in a victory pose, possibly making fists or a "V" sign. Huge, ecstatic smile. 
  Head might be tilted back slightly. Confetti or sparkles might be falling around them. This 
  is pure, unbridled joy and achievement.

- **Artistic Style:** Kawaii, Pastel colors, Smooth lines, Gradient shading.

- **Animation:** A subtle, looping animation in the style of 'Bouncing'. The animation must 
  be a perfect, seamless loop.

- **Composition:** Full-Body.

- **Advanced Animation Settings:** Speed: 1x, Loop: infinite, Easing: ease-out.

- **Output:** The final output should have a transparent background if possible.
```

**Process**:
1. Job submitted to Veo API
2. Polling every 10 seconds for completion
3. Progress: 0% → 45% → 95% (rendering) → 100%
4. Video downloaded and converted to data URL
5. Takes ~2-3 minutes total

**Model Difference**: Video models work differently - they interpret motion, timing, and seamless looping automatically!

---

### 6.4 Text-to-Image Mode (No Identity Lock)

**Purpose**: Creates fictional characters without photo  
**Model**: `gemini-2.5-flash-image-preview`  
**Inputs**: Text descriptions only

#### **Real Example: Creating a Wizard Cat**

**Settings Used**:
- Input Mode: From Text
- Subject: "A wise wizard cat"
- Key Characteristics: "Wearing star-patterned robes, has green eyes, long white beard"
- Expression: Thinking
- Style: Cartoon Vector

**Actual Prompt Sent**:

```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers. 
Your primary duty is to maintain perfect consistency with the provided Identity Lock profile.

**Primary Directive:** The generated sticker MUST be a perfect likeness of the person in the 
provided photograph. All facial features, hair, and defining characteristics MUST be preserved exactly.

**Identity Anchor:**
- **The character is the person** in the provided photograph.
- **Detailed Analysis:** {"subject":"A wise wizard cat","keyCharacteristics":"Wearing star-patterned 
  robes, has green eyes, long white beard"}

**Sticker Task:**
1. **Expression/Pose:** Create a sticker of the character with the following expression: 
   "The character is in a thoughtful pose, with one paw/hand on their chin (or equivalent 
   for their form), looking slightly upward as if pondering. A small lightbulb might appear 
   above their head. The expression conveys deep thought, contemplation, or problem-solving."

2. **Artistic Style:**
   - **Overall Style:** Cartoon Vector
   - **Color Palette:** Vibrant
   - **Line Style:** Smooth
   - **Shading Style:** Cel-shading

3. **Composition:** Half-Body

4. **Output Format:** The final image MUST have a transparent background (alpha channel). 
   It should be a professional, high-quality sticker.

5. **Negative Prompts:** Avoid the following: blurry, low-quality, text, watermarks
```

**Key Difference**: No actual photo provided - AI invents the character based on text description. Identity Lock is bypassed entirely!

---

### 6.5 Pose from Image (Special Case)

**Purpose**: Uses exact pose from uploaded photo  
**Credit Cost**: Only 1 credit (cheapest option!)

#### **Real Example: Custom Pose**

**Your Photo**: Shows you doing a peace sign with head tilted

**Pose Analysis** (automatic):
```
"A person smiling and making a peace sign with their right hand near their face, head tilted 
slightly to the left."
```

**Actual Prompt Sent**:

```
You are a world-class digital illustrator specializing in clean, vibrant vector art for stickers. 
Your primary duty is to maintain perfect consistency with the provided Identity Lock profile.

**Primary Directive:** The generated sticker MUST be a perfect likeness of the person in the 
provided photograph. All facial features, hair, and defining characteristics MUST be preserved exactly.

**Identity Anchor:**
- **The character is the person** in the provided photograph.
- **Detailed Analysis:** [Your identity template]

**Sticker Task:**
1. **Expression/Pose:** Create a sticker of the character with the following expression: 
   "Use the exact pose and expression from the provided photo. Original photo description: 
   A person smiling and making a peace sign with their right hand near their face, head tilted 
   slightly to the left."

2. **Artistic Style:**
   - **Overall Style:** Cartoon Vector
   - **Color Palette:** Vibrant
   - **Line Style:** Smooth
   - **Shading Style:** Cel-shading

3. **Composition:** Half-Body

4. **Output Format:** The final image MUST have a transparent background (alpha channel). 
   It should be a professional, high-quality sticker.

5. **Negative Prompts:** Avoid the following: blurry, low-quality, text, watermarks
```

**Why It's Cheaper**: AI doesn't need to "invent" a new pose - it just stylizes your existing one!

---

### 6.6 Group Photo Processing

**Purpose**: Handles multiple people in one photo  
**Special Handling**: Identity template becomes an array

#### **Detection**:

When you upload a group photo, the system analyzes:
```json
[
  {
    "person": "Person on left",
    "bone_structure": {...},
    "eye_biometrics": {...}
  },
  {
    "person": "Person on right",
    "bone_structure": {...},
    "eye_biometrics": {...}
  }
]
```

**Prompt Modification**:

The prompt changes from:
- "The character is the person" (singular)

To:
- "The characters are the people" (plural)

**Full Prompt Example**:

```
**Identity Anchor:**
- **The characters are the people** in the provided photograph.
- **Detailed Analysis:** [Array with 2+ identity templates]

**Sticker Task:**
1. **Expression/Pose:** Create a sticker of the characters with the following expression: 
   "The characters are both laughing hysterically..."
```

**Result**: All people in the photo maintain their identities in the sticker!

---

### 6.7 Style Variations: How Settings Change Prompts

#### **Photorealistic Style**:
```
**Artistic Style:**
- **Overall Style:** Photorealistic
- **Color Palette:** Vibrant
- **Line Style:** None  ← No outlines for photos!
- **Shading Style:** Gradient  ← Realistic depth
```

#### **Kawaii Style**:
```
**Artistic Style:**
- **Overall Style:** Kawaii
- **Color Palette:** Pastel  ← Soft, cute colors
- **Line Style:** Smooth
- **Shading Style:** Cel-shading  ← Anime-style shading
```

#### **WPAP Style**:
```
**Artistic Style:**
- **Overall Style:** WPAP
- **Color Palette:** Vibrant
- **Line Style:** Bold  ← Thick geometric lines
- **Shading Style:** Flat  ← No gradients, solid colors
```

---

### 6.8 Negative Prompts (Hidden)

Every generation includes these automatic negative prompts:

**Default Negative Prompt**:
```
blurry, low-quality, text, watermarks, distorted, deformed, disfigured, bad anatomy, 
wrong proportions, extra limbs, mutated hands, fused fingers, too many fingers, 
long neck, cross-eyed, mutation, poorly drawn, ugly, tiling, out of frame, 
body out of frame, cut off, draft, duplicate, morbid, mutilated, extra fingers, 
missing arms, missing legs, extra arms, extra legs, malformed limbs, floating limbs
```

**Why Hidden**: These are baked into the generation system to prevent common AI artifacts. Users can't edit them (for quality control).

---

### 6.9 Validation Prompt (Identity Lock V2)

**Purpose**: Scores generated sticker for identity match  
**Model**: `gemini-2.5-flash`  
**Output**: JSON with score

**Actual Validation Prompt**:

```
Forensic facial comparison. Compare these images (should be SAME person):

IMAGE 1: Neutral reference (ground truth)
IMAGE 2: Generated stylized image

IDENTITY TO VERIFY:
This person has an oval face shape with a soft, slightly rounded jawline and moderate 
cheekbone prominence. Their warm dark brown eyes are almond-shaped with double eyelids...
[Full fingerprint]

Analyze: face shape, eyes, nose, mouth, distinctive features, proportions

SCORING:
95-100: Perfect match
85-94: Strong match, minor deviations
70-84: Recognizable but notable differences
<70: Identity not preserved (FAILED)

OUTPUT JSON:
{
  "similarityScore": <0-100>,
  "isValid": <true if >= 85>,
  "issues": [<specific problems>],
  "analysis": "<brief explanation>"
}
```

**Example Response**:

```json
{
  "similarityScore": 92,
  "isValid": true,
  "issues": [],
  "analysis": "Strong identity match. Face shape, eye characteristics, nose structure, and 
  distinctive features (dimples, beauty mark, earrings) all preserved accurately. Minor artistic 
  liberties in hair texture are acceptable for the chosen Cartoon Vector style."
}
```

**Temperature**: 0.1 (very deterministic for objective scoring)

---

### 6.10 What This Means For You

**Understanding real prompts helps you**:

1. **Write Better Text-to-Image Descriptions**  
   You see the AI expects structured data → Describe your character systematically (face, eyes, hair, clothes)

2. **Choose Appropriate Photos**  
   The identity template extracts bone structure, eye shape, nose → These must be clearly visible in your photo

3. **Understand Style Limitations**  
   WPAP requires "Flat" shading, Photorealistic needs "None" lines → The system prevents impossible combinations

4. **Optimize Pack Size**  
   Each sticker costs 1 credit but uses the same identity template → Large packs are cost-effective!

5. **Trust the Validation System**  
   Scores 85-94 are "Strong match" → Don't obsess over perfect 100 scores

6. **Speech Bubbles Are Baked In**  
   The text goes directly into the expression description → AI generates it as part of the image, not overlaid

7. **Animation is Different**  
   Video model interprets motion naturally → You don't need to specify "move up and down" for bouncing

---

**END OF GUIDE**

For questions, issues, or feedback, please refer to the project documentation or submit an issue on the repository.

**Version**: 1.0  
**Document Length**: Complete comprehensive guide  
**Last Updated**: October 17, 2025

